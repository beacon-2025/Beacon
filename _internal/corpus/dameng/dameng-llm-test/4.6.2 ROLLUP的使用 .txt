-- 创建表 PERSON.ADDRESS
CREATE TABLE PERSON.ADDRESS (
    CITY VARCHAR(50),
    ADDRESS1 VARCHAR(100)
);
-- 插入测试数据
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区 369号金地太阳城 56-1-202');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区 369号金地太阳城 57-2-302');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区保利花园 50-1-304');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区保利花园 51-1-702');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区关山春晓 51-1-702');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区关山春晓 55-1-202');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区关山春晓 10-1-202');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区关山春晓 11-1-202');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区光谷软件园 C1_501');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市青山区', '青山区青翠苑 1号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市武昌区', '武昌区武船新村 115号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市武昌区', '武昌区武船新村 1号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市汉阳区', '汉阳大道熊家湾 15号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市江汉区', '江汉区发展大道 561号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市江汉区', '江汉区发展大道 555号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市江汉区', '江汉区发展大道 423号');
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计
SELECT CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY ROLLUP(CITY, ADDRESS1);
-- 使用 ROLLUP 仅对 CITY 进行分组统计
SELECT CITY, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY ROLLUP(CITY);
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计
SELECT CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY ROLLUP(CITY, ADDRESS1);
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并过滤掉 NULL 值
SELECT CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY ROLLUP(CITY, ADDRESS1)
HAVING CITY IS NOT NULL AND ADDRESS1 IS NOT NULL;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并按 CITY 排序
SELECT CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY ROLLUP(CITY, ADDRESS1)
ORDER BY CITY;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并限制返回的行数
SELECT CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY ROLLUP(CITY, ADDRESS1)
LIMIT 10;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并在嵌套查询中使用
SELECT CITY, ADDRESS1, NUMS
FROM (
    SELECT CITY, ADDRESS1, COUNT(*) AS NUMS
    FROM PERSON.ADDRESS
    GROUP BY ROLLUP(CITY, ADDRESS1)
) AS subquery
WHERE NUMS > 1;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与另一个查询结果联合
SELECT CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY ROLLUP(CITY, ADDRESS1)
UNION ALL
SELECT CITY, NULL, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY CITY;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并过滤掉某些分组
SELECT CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY ROLLUP(CITY, ADDRESS1)
HAVING NUMS > 1;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并添加额外的分组列
SELECT CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY ROLLUP(CITY, ADDRESS1), CITY;
-- 创建另一个表 PERSON.EMPLOYEE
CREATE TABLE PERSON.EMPLOYEE (
    EMPLOYEE_ID INT,
    CITY VARCHAR(50)
);
-- 插入测试数据
INSERT INTO PERSON.EMPLOYEE (EMPLOYEE_ID, CITY) VALUES (1, '武汉市洪山区');
INSERT INTO PERSON.EMPLOYEE (EMPLOYEE_ID, CITY) VALUES (2, '武汉市青山区');
INSERT INTO PERSON.EMPLOYEE (EMPLOYEE_ID, CITY) VALUES (3, '武汉市武昌区');
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 表连接
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1);
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 表连接，并过滤结果
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1)
HAVING NUMS > 1;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 表连接，并排序
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1)
ORDER BY A.CITY;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 表连接，并限制返回的行数
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1)
LIMIT 5;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 表连接，并在嵌套查询中使用
SELECT A.CITY, A.ADDRESS1, NUMS
FROM (
    SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
    FROM PERSON.ADDRESS A
    JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
    GROUP BY ROLLUP(A.CITY, A.ADDRESS1)
) AS subquery
WHERE NUMS > 1;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 表连接，并与另一个查询结果联合
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1)
UNION ALL
SELECT A.CITY, NULL, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
GROUP BY A.CITY;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 表连接，并过滤掉某些分组
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1)
HAVING NUMS > 1;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 表连接，并添加额外的分组列
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1), A.CITY;
-- 创建另一个表 PERSON.DEPARTMENT
CREATE TABLE PERSON.DEPARTMENT (
    DEPARTMENT_ID INT,
    CITY VARCHAR(50)
);
-- 插入测试数据
INSERT INTO PERSON.DEPARTMENT (DEPARTMENT_ID, CITY) VALUES (1, '武汉市洪山区');
INSERT INTO PERSON.DEPARTMENT (DEPARTMENT_ID, CITY) VALUES (2, '武汉市青山区');
INSERT INTO PERSON.DEPARTMENT (DEPARTMENT_ID, CITY) VALUES (3, '武汉市武昌区');
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 和 DEPARTMENT 表连接
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
JOIN PERSON.DEPARTMENT D ON A.CITY = D.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1);
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 和 DEPARTMENT 表连接，并过滤结果
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
JOIN PERSON.DEPARTMENT D ON A.CITY = D.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1)
HAVING NUMS > 1;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 和 DEPARTMENT 表连接，并排序
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
JOIN PERSON.DEPARTMENT D ON A.CITY = D.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1)
ORDER BY A.CITY;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 和 DEPARTMENT 表连接，并限制返回的行数
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
JOIN PERSON.DEPARTMENT D ON A.CITY = D.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1)
LIMIT 5;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 和 DEPARTMENT 表连接，并在嵌套查询中使用
SELECT A.CITY, A.ADDRESS1, NUMS
FROM (
    SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
    FROM PERSON.ADDRESS A
    JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
    JOIN PERSON.DEPARTMENT D ON A.CITY = D.CITY
    GROUP BY ROLLUP(A.CITY, A.ADDRESS1)
) AS subquery
WHERE NUMS > 1;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 和 DEPARTMENT 表连接，并与另一个查询结果联合
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
JOIN PERSON.DEPARTMENT D ON A.CITY = D.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1)
UNION ALL
SELECT A.CITY, NULL, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
JOIN PERSON.DEPARTMENT D ON A.CITY = D.CITY
GROUP BY A.CITY;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 和 DEPARTMENT 表连接，并过滤掉某些分组
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
JOIN PERSON.DEPARTMENT D ON A.CITY = D.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1)
HAVING NUMS > 1;
-- 使用 ROLLUP 对 CITY 和 ADDRESS1 进行分组统计，并与 EMPLOYEE 和 DEPARTMENT 表连接，并添加额外的分组列
SELECT A.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS A
JOIN PERSON.EMPLOYEE E ON A.CITY = E.CITY
JOIN PERSON.DEPARTMENT D ON A.CITY = D.CITY
GROUP BY ROLLUP(A.CITY, A.ADDRESS1), A.CITY