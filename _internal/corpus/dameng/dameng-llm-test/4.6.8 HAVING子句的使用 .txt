-- 创建PRODUCTION.PRODUCT表
CREATE TABLE PRODUCTION.PRODUCT (
    PRODUCTID INT PRIMARY KEY,
    PRODUCTNAME VARCHAR(100),
    PRODUCT_SUBCATEGORYID INT
);
-- 创建PRODUCTION.PRODUCT_SUBCATEGORY表
CREATE TABLE PRODUCTION.PRODUCT_SUBCATEGORY (
    PRODUCT_SUBCATEGORYID INT PRIMARY KEY,
    NAME VARCHAR(100)
);
-- 插入测试数据到PRODUCTION.PRODUCT表
INSERT INTO PRODUCTION.PRODUCT (PRODUCTID, PRODUCTNAME, PRODUCT_SUBCATEGORYID) VALUES
(1, 'Product A', 1),
(2, 'Product B', 1),
(3, 'Product C', 2),
(4, 'Product D', 2),
(5, 'Product E', 3);
-- 插入测试数据到PRODUCTION.PRODUCT_SUBCATEGORY表
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, NAME) VALUES
(1, 'Subcategory 1'),
(2, 'Subcategory 2'),
(3, 'Subcategory 3');
SELECT A2.NAME AS 子分类名, COUNT(*) AS 数量
FROM PRODUCTION.PRODUCT A1
JOIN PRODUCTION.PRODUCT_SUBCATEGORY A2
ON A1.PRODUCT_SUBCATEGORYID = A2.PRODUCT_SUBCATEGORYID
GROUP BY A2.NAME
HAVING COUNT(*) > 1
ORDER BY 数量;
SELECT A2.NAME AS 子分类名, COUNT(*) AS 数量
FROM PRODUCTION.PRODUCT A1
JOIN PRODUCTION.PRODUCT_SUBCATEGORY A2
ON A1.PRODUCT_SUBCATEGORYID = A2.PRODUCT_SUBCATEGORYID
GROUP BY A2.NAME
HAVING COUNT(*) > 2
ORDER BY 数量 DESC;
SELECT A2.NAME AS 子分类名, COUNT(*) AS 数量
FROM PRODUCTION.PRODUCT A1
JOIN PRODUCTION.PRODUCT_SUBCATEGORY A2
ON A1.PRODUCT_SUBCATEGORYID = A2.PRODUCT_SUBCATEGORYID
GROUP BY A2.NAME
HAVING COUNT(*) = 1
ORDER BY 子分类名;
SELECT A2.NAME AS 子分类名, COUNT(*) AS 数量
FROM PRODUCTION.PRODUCT A1
JOIN PRODUCTION.PRODUCT_SUBCATEGORY A2
ON A1.PRODUCT_SUBCATEGORYID = A2.PRODUCT_SUBCATEGORYID
GROUP BY A2.NAME
HAVING COUNT(*) > 0
ORDER BY 子分类名;
SELECT A2.NAME AS 子分类名, COUNT(*) AS 数量
FROM PRODUCTION.PRODUCT A1
JOIN PRODUCTION.PRODUCT_SUBCATEGORY A2
ON A1.PRODUCT_SUBCATEGORYID = A2.PRODUCT_SUBCATEGORYID
GROUP BY A2.NAME
HAVING COUNT(*) < 3
ORDER BY 数量;
SELECT A2.NAME AS 子分类名, COUNT(*) AS 数量
FROM PRODUCTION.PRODUCT A1
JOIN PRODUCTION.PRODUCT_SUBCATEGORY A2
ON A1.PRODUCT_SUBCATEGORYID = A2.PRODUCT_SUBCATEGORYID
GROUP BY A2.NAME
HAVING COUNT(*) > 1 AND COUNT(*) < 3
ORDER BY 数量;
SELECT A2.NAME AS 子分类名, COUNT(*) AS 数量
FROM PRODUCTION.PRODUCT A1
JOIN PRODUCTION.PRODUCT_SUBCATEGORY A2
ON A1.PRODUCT_SUBCATEGORYID = A2.PRODUCT_SUBCATEGORYID
GROUP BY A2.NAME
HAVING COUNT(*) > 1
ORDER BY 子分类名 DESC;
SELECT A2.NAME AS 子分类名, COUNT(*) AS 数量
FROM PRODUCTION.PRODUCT A1
JOIN PRODUCTION.PRODUCT_SUBCATEGORY A2
ON A1.PRODUCT_SUBCATEGORYID = A2.PRODUCT_SUBCATEGORYID
GROUP BY A2.NAME
HAVING COUNT(*) > 1
ORDER BY 数量 DESC;
SELECT A2.NAME AS 子分类名, COUNT(*) AS 数量
FROM PRODUCTION.PRODUCT A1
JOIN PRODUCTION.PRODUCT_SUBCATEGORY A2
ON A1.PRODUCT_SUBCATEGORYID = A2.PRODUCT_SUBCATEGORYID
GROUP BY A2.NAME
HAVING COUNT(*) > 1
ORDER BY 子分类名 ASC;
SELECT A2.NAME AS 子分类名, COUNT(*) AS 数量
FROM PRODUCTION.PRODUCT A1
JOIN PRODUCTION.PRODUCT_SUBCATEGORY A2
ON A1.PRODUCT_SUBCATEGORYID = A2.PRODUCT_SUBCATEGORYID
GROUP BY A2.NAME
HAVING COUNT(*) > 1
ORDER BY 数量 ASC