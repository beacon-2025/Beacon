-- 创建表 SYSOBJECTS
CREATE TABLE SYSOBJECTS (
    NAME VARCHAR(100),
    schid INT,
    SUBTYPE$ VARCHAR(50),
    TYPE$ VARCHAR(50)
);
-- 插入测试数据
INSERT INTO SYSOBJECTS (NAME, schid, SUBTYPE$, TYPE$) VALUES ('Table1', 1, 'STAB', 'TABLE');
INSERT INTO SYSOBJECTS (NAME, schid, SUBTYPE$, TYPE$) VALUES ('Table2', 2, 'STAB', 'TABLE');
INSERT INTO SYSOBJECTS (NAME, schid, SUBTYPE$, TYPE$) VALUES ('View1', 3, 'VIEW', 'VIEW');
INSERT INTO SYSOBJECTS (NAME, schid, SUBTYPE$, TYPE$) VALUES ('Synonym1', 4, 'STAB', 'DSYNOM');
INSERT INTO SYSOBJECTS (NAME, schid, SUBTYPE$, TYPE$) VALUES ('Synonym2', 5, 'STAB', 'DSYNOM');
-- 测试用例 1: 查看简单查询的执行计划
EXPLAIN SELECT NAME, schid FROM SYSOBJECTS WHERE SUBTYPE$ = 'STAB';
-- 测试用例 2: 查看带有子查询的查询的执行计划
EXPLAIN SELECT NAME, schid 
FROM SYSOBJECTS 
WHERE SUBTYPE$ = 'STAB' AND NAME NOT IN (
    SELECT NAME FROM SYSOBJECTS WHERE TYPE$ = 'DSYNOM'
);
-- 测试用例 3: 查看带有嵌套子查询的查询的执行计划
EXPLAIN SELECT NAME, schid 
FROM SYSOBJECTS 
WHERE SUBTYPE$ = 'STAB' AND NAME NOT IN (
    SELECT NAME FROM SYSOBJECTS WHERE NAME IN (
        SELECT NAME FROM SYSOBJECTS WHERE SUBTYPE$ = 'STAB'
    ) AND TYPE$ = 'DSYNOM'
);
-- 测试用例 4: 查看插入语句的执行计划
EXPLAIN INSERT INTO SYSOBJECTS (NAME, schid, SUBTYPE$, TYPE$) VALUES ('NewTable', 6, 'STAB', 'TABLE');
-- 测试用例 5: 查看更新语句的执行计划
EXPLAIN UPDATE SYSOBJECTS SET TYPE$ = 'VIEW' WHERE NAME = 'Table1';
-- 测试用例 6: 查看删除语句的执行计划
EXPLAIN DELETE FROM SYSOBJECTS WHERE NAME = 'Table2';
-- 测试用例 7: 查看带有复杂条件的查询的执行计划
EXPLAIN SELECT NAME, schid 
FROM SYSOBJECTS 
WHERE SUBTYPE$ = 'STAB' AND (TYPE$ = 'TABLE' OR TYPE$ = 'VIEW');
-- 测试用例 8: 查看带有排序的查询的执行计划
EXPLAIN SELECT NAME, schid 
FROM SYSOBJECTS 
WHERE SUBTYPE$ = 'STAB' 
ORDER BY NAME DESC;
-- 测试用例 9: 查看带有分组的查询的执行计划
EXPLAIN SELECT TYPE$, COUNT(*) 
FROM SYSOBJECTS 
GROUP BY TYPE$;
-- 测试用例 10: 查看带有分组的查询的执行计划
EXPLAIN SELECT TYPE$, COUNT(*) 
FROM SYSOBJECTS 
WHERE SUBTYPE$ = 'STAB' 
GROUP BY TYPE$ 
HAVING COUNT(*) > 1