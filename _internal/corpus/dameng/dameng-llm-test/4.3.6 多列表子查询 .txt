-- 公共前置语句：创建必要的表和插入数据
CREATE TABLE PURCHASING.VENDOR (
    VENDORID INT PRIMARY KEY,
    NAME VARCHAR(100),
    ACTIVEFLAG INT,
    CREDIT INT
);
CREATE TABLE PRODUCTION.PRODUCT (
    PRODUCTID INT PRIMARY KEY,
    NAME VARCHAR(100),
    AUTHOR VARCHAR(100),
    PUBLISHER VARCHAR(100),
    NOWPRICE DECIMAL(10, 4)
);
CREATE TABLE PURCHASING.PURCHASEORDER_HEADER (
    ORDERID INT PRIMARY KEY,
    ORDERDATE DATE,
    STATUS INT,
    TOTAL DECIMAL(10, 2),
    EMPLOYEEID INT,
    VENDORID INT
);
CREATE TABLE RESOURCES.EMPLOYEE (
    EMPLOYEEID INT PRIMARY KEY,
    NAME VARCHAR(100),
    TITLE VARCHAR(100)
);
INSERT INTO PURCHASING.VENDOR (VENDORID, NAME, ACTIVEFLAG, CREDIT) VALUES
(1, '上海画报出版社', 1, 2),
(2, '长江文艺出版社', 0, 1),
(3, '清华大学出版社', 1, 3);
INSERT INTO PRODUCTION.PRODUCT (PRODUCTID, NAME, AUTHOR, PUBLISHER, NOWPRICE) VALUES
(1, '老人与海', '海明威', '上海出版社', 6.1000),
(2, '长征', '王树增', '人民文学出版社', 37.7000),
(3, '战争与和平', '托尔斯泰', '人民文学出版社', 45.0000);
INSERT INTO PURCHASING.PURCHASEORDER_HEADER (ORDERID, ORDERDATE, STATUS, TOTAL, EMPLOYEEID, VENDORID) VALUES
(1, '2006-07-21', 1, 6400.00, 101, 3),
(2, '2006-08-15', 2, 3200.00, 102, 1);
INSERT INTO RESOURCES.EMPLOYEE (EMPLOYEEID, NAME, TITLE) VALUES
(101, '张三', '采购代表'),
(102, '李四', '销售代表');
-- 测试用例1：查询活动标志为1且信誉为2的供应商编号和名称
SELECT VENDORID, NAME
FROM PURCHASING.VENDOR
WHERE (ACTIVEFLAG, CREDIT) IN ((1, 2));
-- 测试用例2：查询作者为海明威且出版社为上海出版社或作者为王树增且出版社为人民文学出版社的图书名称和现在销售价格
SELECT NAME, NOWPRICE
FROM PRODUCTION.PRODUCT
WHERE (AUTHOR, PUBLISHER) IN (('海明威', '上海出版社'), ('王树增', '人民文学出版社'));
-- 测试用例3：查询由采购代表下的供应商是清华大学出版社的订单的创建日期、状态和应付款总额
SELECT ORDERDATE, STATUS, TOTAL
FROM PURCHASING.PURCHASEORDER_HEADER
WHERE (EMPLOYEEID, VENDORID) IN (
    SELECT T1.EMPLOYEEID, T2.VENDORID
    FROM RESOURCES.EMPLOYEE T1, PURCHASING.VENDOR T2
    WHERE T1.TITLE = '采购代表' AND T2.NAME = '清华大学出版社'
);
-- 测试用例4：查询活动标志为0且信誉为1的供应商编号和名称
SELECT VENDORID, NAME
FROM PURCHASING.VENDOR
WHERE (ACTIVEFLAG, CREDIT) IN ((0, 1));
-- 测试用例5：查询作者为托尔斯泰且出版社为人民文学出版社的图书名称和现在销售价格
SELECT NAME, NOWPRICE
FROM PRODUCTION.PRODUCT
WHERE (AUTHOR, PUBLISHER) IN (('托尔斯泰', '人民文学出版社'));
-- 测试用例6：查询由销售代表下的供应商是上海画报出版社的订单的创建日期、状态和应付款总额
SELECT ORDERDATE, STATUS, TOTAL
FROM PURCHASING.PURCHASEORDER_HEADER
WHERE (EMPLOYEEID, VENDORID) IN (
    SELECT T1.EMPLOYEEID, T2.VENDORID
    FROM RESOURCES.EMPLOYEE T1, PURCHASING.VENDOR T2
    WHERE T1.TITLE = '销售代表' AND T2.NAME = '上海画报出版社'
);
-- 测试用例7：查询活动标志为1且信誉为3的供应商编号和名称
SELECT VENDORID, NAME
FROM PURCHASING.VENDOR
WHERE (ACTIVEFLAG, CREDIT) IN ((1, 3));
-- 测试用例8：查询作者为海明威且出版社为上海出版社的图书名称和现在销售价格
SELECT NAME, NOWPRICE
FROM PRODUCTION.PRODUCT
WHERE (AUTHOR, PUBLISHER) IN (('海明威', '上海出版社'));
-- 测试用例9：查询由采购代表下的供应商是长江文艺出版社的订单的创建日期、状态和应付款总额
SELECT ORDERDATE, STATUS, TOTAL
FROM PURCHASING.PURCHASEORDER_HEADER
WHERE (EMPLOYEEID, VENDORID) IN (
    SELECT T1.EMPLOYEEID, T2.VENDORID
    FROM RESOURCES.EMPLOYEE T1, PURCHASING.VENDOR T2
    WHERE T1.TITLE = '采购代表' AND T2.NAME = '长江文艺出版社'
);
-- 测试用例10：查询活动标志为1且信誉为1的供应商编号和名称
SELECT VENDORID, NAME
FROM PURCHASING.VENDOR
WHERE (ACTIVEFLAG, CREDIT) IN ((1, 1))