-- 创建EMPLOYEE表
CREATE TABLE RESOURCES.EMPLOYEE (
    EMPLOYEE_ID INT PRIMARY KEY,
    HAIRDATE DATE,
    DEPARTMENT VARCHAR(50)
);
-- 创建SALESPERSON表
CREATE TABLE SALES.SALESPERSON (
    EMPLOYEE_ID INT PRIMARY KEY,
    SALESLASTYEAR DECIMAL(10, 4),
    REGION VARCHAR(50)
);
-- 插入EMPLOYEE表数据
INSERT INTO RESOURCES.EMPLOYEE (EMPLOYEE_ID, HAIRDATE, DEPARTMENT) VALUES
(1, '2002-05-02', 'Sales'),
(2, '2003-06-15', 'Marketing'),
(3, '2001-07-20', 'Sales');
-- 插入SALESPERSON表数据
INSERT INTO SALES.SALESPERSON (EMPLOYEE_ID, SALESLASTYEAR, REGION) VALUES
(1, 10000.00, 'North'),
(2, 20000.00, 'South'),
(3, 15000.00, 'East');
-- 测试用例1: 基本自然连接查询
SELECT T1.HAIRDATE, T2.SALESLASTYEAR
FROM RESOURCES.EMPLOYEE T1
NATURAL JOIN SALES.SALESPERSON T2;
-- 测试用例2: 自然连接查询，包含多个同名列
-- 创建EMPLOYEE2表
CREATE TABLE RESOURCES.EMPLOYEE2 (
    EMPLOYEE_ID INT PRIMARY KEY,
    HAIRDATE DATE,
    DEPARTMENT VARCHAR(50),
    REGION VARCHAR(50)
);
-- 创建SALESPERSON2表
CREATE TABLE SALES.SALESPERSON2 (
    EMPLOYEE_ID INT PRIMARY KEY,
    SALESLASTYEAR DECIMAL(10, 4),
    REGION VARCHAR(50)
);
-- 插入EMPLOYEE2表数据
INSERT INTO RESOURCES.EMPLOYEE2 (EMPLOYEE_ID, HAIRDATE, DEPARTMENT, REGION) VALUES
(1, '2002-05-02', 'Sales', 'North'),
(2, '2003-06-15', 'Marketing', 'South'),
(3, '2001-07-20', 'Sales', 'East');
-- 插入SALESPERSON2表数据
INSERT INTO SALES.SALESPERSON2 (EMPLOYEE_ID, SALESLASTYEAR, REGION) VALUES
(1, 10000.00, 'North'),
(2, 20000.00, 'South'),
(3, 15000.00, 'East');
-- 查询
SELECT T1.HAIRDATE, T2.SALESLASTYEAR
FROM RESOURCES.EMPLOYEE2 T1
NATURAL JOIN SALES.SALESPERSON2 T2;
-- 测试用例3: 自然连接查询，同名列类型不匹配
-- 创建EMPLOYEE3表
CREATE TABLE RESOURCES.EMPLOYEE3 (
    EMPLOYEE_ID VARCHAR(10) PRIMARY KEY,
    HAIRDATE DATE,
    DEPARTMENT VARCHAR(50)
);
-- 创建SALESPERSON3表
CREATE TABLE SALES.SALESPERSON3 (
    EMPLOYEE_ID INT PRIMARY KEY,
    SALESLASTYEAR DECIMAL(10, 4),
    REGION VARCHAR(50)
);
-- 插入EMPLOYEE3表数据
INSERT INTO RESOURCES.EMPLOYEE3 (EMPLOYEE_ID, HAIRDATE, DEPARTMENT) VALUES
('1', '2002-05-02', 'Sales'),
('2', '2003-06-15', 'Marketing'),
('3', '2001-07-20', 'Sales');
-- 插入SALESPERSON3表数据
INSERT INTO SALES.SALESPERSON3 (EMPLOYEE_ID, SALESLASTYEAR, REGION) VALUES
(1, 10000.00, 'North'),
(2, 20000.00, 'South'),
(3, 15000.00, 'East');
-- 查询（预期报错）
SELECT T1.HAIRDATE, T2.SALESLASTYEAR
FROM RESOURCES.EMPLOYEE3 T1
NATURAL JOIN SALES.SALESPERSON3 T2;
-- 测试用例4: 自然连接查询，无同名列
-- 创建EMPLOYEE4表
CREATE TABLE RESOURCES.EMPLOYEE4 (
    EMPLOYEE_ID INT PRIMARY KEY,
    HAIRDATE DATE,
    DEPARTMENT VARCHAR(50)
);
-- 创建SALESPERSON4表
CREATE TABLE SALES.SALESPERSON4 (
    SALESPERSON_ID INT PRIMARY KEY,
    SALESLASTYEAR DECIMAL(10, 4),
    REGION VARCHAR(50)
);
-- 插入EMPLOYEE4表数据
INSERT INTO RESOURCES.EMPLOYEE4 (EMPLOYEE_ID, HAIRDATE, DEPARTMENT) VALUES
(1, '2002-05-02', 'Sales'),
(2, '2003-06-15', 'Marketing'),
(3, '2001-07-20', 'Sales');
-- 插入SALESPERSON4表数据
INSERT INTO SALES.SALESPERSON4 (SALESPERSON_ID, SALESLASTYEAR, REGION) VALUES
(1, 10000.00, 'North'),
(2, 20000.00, 'South'),
(3, 15000.00, 'East');
-- 查询（预期无结果）
SELECT T1.HAIRDATE, T2.SALESLASTYEAR
FROM RESOURCES.EMPLOYEE4 T1
NATURAL JOIN SALES.SALESPERSON4 T2;
-- 测试用例5: 自然连接查询，多个同名列
-- 创建EMPLOYEE5表
CREATE TABLE RESOURCES.EMPLOYEE5 (
    EMPLOYEE_ID INT PRIMARY KEY,
    HAIRDATE DATE,
    DEPARTMENT VARCHAR(50),
    REGION VARCHAR(50)
);
-- 创建SALESPERSON5表
CREATE TABLE SALES.SALESPERSON5 (
    EMPLOYEE_ID INT PRIMARY KEY,
    SALESLASTYEAR DECIMAL(10, 4),
    REGION VARCHAR(50)
);
-- 插入EMPLOYEE5表数据
INSERT INTO RESOURCES.EMPLOYEE5 (EMPLOYEE_ID, HAIRDATE, DEPARTMENT, REGION) VALUES
(1, '2002-05-02', 'Sales', 'North'),
(2, '2003-06-15', 'Marketing', 'South'),
(3, '2001-07-20', 'Sales', 'East');
-- 插入SALESPERSON5表数据
INSERT INTO SALES.SALESPERSON5 (EMPLOYEE_ID, SALESLASTYEAR, REGION) VALUES
(1, 10000.00, 'North'),
(2, 20000.00, 'South'),
(3, 15000.00, 'East');
-- 查询
SELECT T1.HAIRDATE, T2.SALESLASTYEAR
FROM RESOURCES.EMPLOYEE5 T1
NATURAL JOIN SALES.SALESPERSON5 T2