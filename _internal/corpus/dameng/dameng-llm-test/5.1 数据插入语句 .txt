-- 创建模式
CREATE SCHEMA PURCHASING;
CREATE SCHEMA PRODUCTION;
CREATE SCHEMA SALES;
CREATE SCHEMA PERSON;
-- 创建基表
CREATE TABLE PURCHASING.VENDOR (
    ACCOUNTNO VARCHAR(10) NOT NULL,
    NAME VARCHAR(100) NOT NULL,
    ACTIVEFLAG INT NOT NULL,
    WEBURL VARCHAR(200),
    CREDIT INT CHECK(CREDIT IN(1,2,3,4,5))
);
CREATE TABLE PRODUCTION.PRODUCT (
    PRODUCTID INT PRIMARY KEY,
    NAME VARCHAR(100) NOT NULL,
    PUBLISHER VARCHAR(100)
);
CREATE TABLE SALES.SALESORDER_DETAIL (
    SALESORDERID INT,
    PRODUCTID INT,
    FOREIGN KEY (PRODUCTID) REFERENCES PRODUCTION.PRODUCT(PRODUCTID)
);
CREATE TABLE SALES.SALESORDER_HEADER (
    SALESORDERID INT PRIMARY KEY,
    CUSTOMERID INT
);
CREATE TABLE SALES.CUSTOMER (
    CUSTOMERID INT PRIMARY KEY,
    PERSONID INT
);
CREATE TABLE PERSON.PERSON (
    PERSONID INT PRIMARY KEY,
    NAME VARCHAR(100) NOT NULL
);
-- 创建视图
CREATE VIEW PURCHASING.VENDOR_VIEW AS
SELECT ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT
FROM PURCHASING.VENDOR;
-- 创建用于测试的表
CREATE TABLE PRODUCTION.PRODUCT_SELL (
    PRODUCTNAME VARCHAR(50) NOT NULL,
    CUSTOMERNAME VARCHAR(50) NOT NULL
);
CREATE TABLE T10 (
    C BIT
);
-- 插入单行数据
INSERT INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
VALUES ('01', '华中科技大学出版社', 1, '', 2);
-- 插入多行数据
INSERT INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
VALUES ('02', '清华大学出版社', 1, '', 3),
       ('03', '北京大学出版社', 1, '', 4);
-- 插入默认值
INSERT INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
VALUES ('04', '上海交通大学出版社', 1, DEFAULT, 5);
-- 插入查询结果
INSERT INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
SELECT '05', PUBLISHER, 1, '', 1
FROM PRODUCTION.PRODUCT
WHERE NAME = '长征';
-- 插入子查询结果
INSERT INTO PRODUCTION.PRODUCT_SELL
SELECT DISTINCT T1.NAME, T5.NAME
FROM PRODUCTION.PRODUCT T1
JOIN SALES.SALESORDER_DETAIL T2 ON T1.PRODUCTID = T2.PRODUCTID
JOIN SALES.SALESORDER_HEADER T3 ON T2.SALESORDERID = T3.SALESORDERID
JOIN SALES.CUSTOMER T4 ON T3.CUSTOMERID = T4.CUSTOMERID
JOIN PERSON.PERSON T5 ON T4.PERSONID = T5.PERSONID;
-- 插入BIT类型数据
INSERT INTO T10 VALUES(1);
-- 插入 1
INSERT INTO T10 VALUES(0);
-- 插入 0
INSERT INTO T10 VALUES(1.2);
-- 插入 1
INSERT INTO T10 VALUES('000');
-- 插入 0
INSERT INTO T10 VALUES('10');
-- 插入 1;
-- 创建分区表
CREATE TABLE PURCHASING.VENDOR_PARTITIONED (
    ACCOUNTNO VARCHAR(10) NOT NULL,
    NAME VARCHAR(100) NOT NULL,
    ACTIVEFLAG INT NOT NULL,
    WEBURL VARCHAR(200),
    CREDIT INT CHECK(CREDIT IN(1,2,3,4,5))
PARTITION BY LIST (CREDIT) (
    PARTITION P1 VALUES (1),
    PARTITION P2 VALUES (2),
    PARTITION P3 VALUES (3),
    PARTITION P4 VALUES (4),
    PARTITION P5 VALUES (5)
);
-- 插入到分区表
INSERT INTO PURCHASING.VENDOR_PARTITIONED PARTITION (P1)
VALUES ('06', '华中科技大学出版社', 1, '', 1);
-- 插入到视图
INSERT INTO PURCHASING.VENDOR_VIEW(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
VALUES ('07', '华中科技大学出版社', 1, '', 2);
-- 插入到远程表
INSERT INTO PURCHASING.VENDOR@REMOTE_DBLINK(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
VALUES ('08', '华中科技大学出版社', 1, '', 2);
-- 插入大数据文件
@INSERT INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
VALUES(@'/home/user/datafile.jpg');
-- 创建索引表
CREATE TABLE PURCHASING.VENDOR_INDEXED (
    ACCOUNTNO VARCHAR(10) NOT NULL,
    NAME VARCHAR(100) NOT NULL,
    ACTIVEFLAG INT NOT NULL,
    WEBURL VARCHAR(200),
    CREDIT INT CHECK(CREDIT IN(1,2,3,4,5))
INDEX IDX_VENDOR (ACCOUNTNO);
-- 插入到索引表
INSERT INTO PURCHASING.VENDOR_INDEXED INDEX IDX_VENDOR
VALUES ('09', '华中科技大学出版社', 1, '', 2);
-- 插入到子查询表达式
INSERT INTO (SELECT ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT FROM PURCHASING.VENDOR)
VALUES ('10', '华中科技大学出版社', 1, '', 2);
-- 插入到表别名
INSERT INTO PURCHASING.VENDOR AS V(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
VALUES ('11', '华中科技大学出版社', 1, '', 2);
-- 插入到表别名（省略AS）
INSERT INTO PURCHASING.VENDOR V(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
VALUES ('12', '华中科技大学出版社', 1, '', 2);
-- 插入到表别名（省略列名）
INSERT INTO PURCHASING.VENDOR V
VALUES ('13', '华中科技大学出版社', 1, '', 2);
-- 插入到表别名（省略列名和表别名）
INSERT INTO PURCHASING.VENDOR
VALUES ('14', '华中科技大学出版社', 1, '', 2);
-- 插入到表别名（省略列名和表别名，使用DEFAULT）
INSERT INTO PURCHASING.VENDOR
VALUES ('15', '华中科技大学出版社', 1, DEFAULT, 2);
-- 插入到表别名（省略列名和表别名，使用DEFAULT VALUES）
INSERT INTO PURCHASING.VENDOR
DEFAULT VALUES;
-- 插入到表别名（省略列名和表别名，使用TABLE）
INSERT INTO PURCHASING.VENDOR
TABLE PURCHASING.VENDOR_VIEW;
-- 插入到表别名（省略列名和表别名，使用RETURN INTO）
INSERT INTO PURCHASING.VENDOR
VALUES ('16', '华中科技大学出版社', 1, '', 2)
RETURNING ACCOUNTNO INTO :accountno;
-- 插入到表别名（省略列名和表别名，使用RETURNING BULK COLLECT INTO）
INSERT INTO PURCHASING.VENDOR
VALUES ('17', '华中科技大学出版社', 1, '', 2)
RETURNING ACCOUNTNO BULK COLLECT INTO :accountno_array;
-- 插入到表别名（省略列名和表别名，使用ALL）
INSERT ALL
INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
VALUES ('18', '华中科技大学出版社', 1, '', 2)
INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
VALUES ('19', '清华大学出版社', 1, '', 3)
SELECT * FROM DUAL;
-- 插入到表别名（省略列名和表别名，使用FIRST）
INSERT FIRST
WHEN CREDIT = 2 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('20', '华中科技大学出版社', 1, '', 2)
WHEN CREDIT = 3 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('21', '清华大学出版社', 1, '', 3)
ELSE
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('22', '北京大学出版社', 1, '', 4)
SELECT * FROM DUAL;
-- 插入到表别名（省略列名和表别名，使用WHEN THEN ELSE）
INSERT ALL
WHEN CREDIT = 2 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('23', '华中科技大学出版社', 1, '', 2)
WHEN CREDIT = 3 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('24', '清华大学出版社', 1, '', 3)
ELSE
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('25', '北京大学出版社', 1, '', 4)
SELECT * FROM DUAL;
-- 插入到表别名（省略列名和表别名，使用WHEN THEN ELSE，多行插入）
INSERT ALL
WHEN CREDIT = 2 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('26', '华中科技大学出版社', 1, '', 2)
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('27', '清华大学出版社', 1, '', 3)
WHEN CREDIT = 3 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('28', '北京大学出版社', 1, '', 4)
ELSE
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('29', '上海交通大学出版社', 1, '', 5)
SELECT * FROM DUAL;
-- 插入到表别名（省略列名和表别名，使用WHEN THEN ELSE，多行插入，使用FIRST）
INSERT FIRST
WHEN CREDIT = 2 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('30', '华中科技大学出版社', 1, '', 2)
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('31', '清华大学出版社', 1, '', 3)
WHEN CREDIT = 3 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('32', '北京大学出版社', 1, '', 4)
ELSE
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('33', '上海交通大学出版社', 1, '', 5)
SELECT * FROM DUAL;
-- 插入到表别名（省略列名和表别名，使用WHEN THEN ELSE，多行插入，使用ALL）
INSERT ALL
WHEN CREDIT = 2 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('34', '华中科技大学出版社', 1, '', 2)
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('35', '清华大学出版社', 1, '', 3)
WHEN CREDIT = 3 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('36', '北京大学出版社', 1, '', 4)
ELSE
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('37', '上海交通大学出版社', 1, '', 5)
SELECT * FROM DUAL;
-- 插入到表别名（省略列名和表别名，使用WHEN THEN ELSE，多行插入，使用FIRST，使用ELSE）
INSERT FIRST
WHEN CREDIT = 2 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('38', '华中科技大学出版社', 1, '', 2)
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('39', '清华大学出版社', 1, '', 3)
WHEN CREDIT = 3 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('40', '北京大学出版社', 1, '', 4)
ELSE
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('41', '上海交通大学出版社', 1, '', 5)
SELECT * FROM DUAL;
-- 插入到表别名（省略列名和表别名，使用WHEN THEN ELSE，多行插入，使用ALL，使用ELSE）
INSERT ALL
WHEN CREDIT = 2 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('42', '华中科技大学出版社', 1, '', 2)
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('43', '清华大学出版社', 1, '', 3)
WHEN CREDIT = 3 THEN
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('44', '北京大学出版社', 1, '', 4)
ELSE
    INTO PURCHASING.VENDOR(ACCOUNTNO, NAME, ACTIVEFLAG, WEBURL, CREDIT)
    VALUES ('45', '上海交通大学出版社', 1, '', 5)
SELECT * FROM DUAL