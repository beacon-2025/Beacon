-- 创建一些基础表用于测试
CREATE TABLE dual (dummy VARCHAR(1));
INSERT INTO dual (dummy) VALUES ('X');
WITH FUNCTION f1(c INT) RETURN INT AS BEGIN RETURN c * 10;
END;
SELECT f1(5236) FROM dual;
WITH FUNCTION f21(c1 INT) RETURN INT AS BEGIN RETURN c1;
END;
SELECT f21(1) FROM dual WHERE 100 IN (
  WITH FUNCTION f22(c1 INT) RETURN INT AS BEGIN RETURN c1 + 2;
END;
FUNCTION f23(c1 INT) RETURN INT AS BEGIN RETURN c1 - 2;
END;
v21(c) AS (SELECT 50 FROM dual)
  SELECT f22(c) + f23(c) FROM v21
);
WITH FUNCTION f31(c INT) RETURN INT AS BEGIN RETURN c * 2;
END;
FUNCTION f32(c INT) RETURN INT AS BEGIN RETURN c + 5;
END;
SELECT f31(10), f32(10) FROM dual;
WITH FUNCTION f41(c INT) RETURN INT AS BEGIN RETURN c * 3;
END;
FUNCTION f42(c INT) RETURN INT AS BEGIN RETURN f41(c) + 2;
END;
SELECT f42(10) FROM dual;
WITH FUNCTION f51(c INT) RETURN INT AS BEGIN RETURN c * 4;
END;
SELECT (SELECT f51(10) FROM dual) AS result FROM dual;
WITH FUNCTION f61(c INT) RETURN INT AS BEGIN RETURN c * 5;
END;
SELECT * FROM dual WHERE f61(10) = 50;
WITH FUNCTION f71(c INT) RETURN INT AS BEGIN RETURN c * 6;
END;
SELECT COUNT(*) FROM dual HAVING f71(10) = 60;
WITH FUNCTION f81(c INT) RETURN INT AS BEGIN RETURN c * 7;
END;
SELECT * FROM dual ORDER BY f81(10);
WITH FUNCTION f91(c INT) RETURN INT AS BEGIN RETURN c * 8;
END;
SELECT f91(10) AS result FROM dual GROUP BY f91(10);
WITH FUNCTION f101(c INT) RETURN INT AS BEGIN RETURN c * 9;
END;
SELECT * FROM dual d1 JOIN dual d2 ON f101(10) = 90;
WITH FUNCTION f111(c INT) RETURN INT AS BEGIN RETURN c * 10;
END;
SELECT f111(10) FROM dual
UNION
SELECT f111(20) FROM dual;
WITH FUNCTION f121(c INT) RETURN INT AS BEGIN RETURN c * 11;
END;
SELECT f121(10) FROM dual
INTERSECT
SELECT f121(10) FROM dual;
WITH FUNCTION f131(c INT) RETURN INT AS BEGIN RETURN c * 12;
END;
SELECT f131(10) FROM dual
EXCEPT
SELECT f131(20) FROM dual;
WITH FUNCTION f141(c INT) RETURN INT AS BEGIN RETURN c * 13;
END;
SELECT CASE WHEN f141(10) = 130 THEN 'Match' ELSE 'No Match' END AS result FROM dual;
WITH FUNCTION f151(c INT) RETURN INT AS BEGIN RETURN c * 14;
END;
SELECT NULLIF(f151(10), 140) AS result FROM dual;
WITH FUNCTION f161(c INT) RETURN INT AS BEGIN RETURN c * 15;
END;
SELECT COALESCE(f161(10), 0) AS result FROM dual;
WITH FUNCTION f171(c INT) RETURN INT AS BEGIN RETURN c * 16;
END;
SELECT CAST(f171(10) AS VARCHAR) AS result FROM dual;
WITH FUNCTION f181(c INT) RETURN INT AS BEGIN RETURN c * 17;
END;
SELECT * FROM dual WHERE EXISTS (SELECT 1 FROM dual WHERE f181(10) = 170);
WITH FUNCTION f191(c INT) RETURN INT AS BEGIN RETURN c * 18;
END;
SELECT * FROM dual WHERE f191(10) IN (180);
WITH FUNCTION f201(c INT) RETURN INT AS BEGIN RETURN c * 19;
END;
SELECT * FROM dual WHERE f201(10) BETWEEN 180 AND 200