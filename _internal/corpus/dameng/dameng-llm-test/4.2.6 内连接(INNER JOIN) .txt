-- 创建 PRODUCT_CATEGORY 表
CREATE TABLE PRODUCTION.PRODUCT_CATEGORY (
    PRODUCT_CATEGORYID INT PRIMARY KEY,
    NAME VARCHAR(100)
);
-- 创建 PRODUCT_SUBCATEGORY 表
CREATE TABLE PRODUCTION.PRODUCT_SUBCATEGORY (
    PRODUCT_SUBCATEGORYID INT PRIMARY KEY,
    PRODUCT_CATEGORYID INT,
    NAME VARCHAR(100),
    FOREIGN KEY (PRODUCT_CATEGORYID) REFERENCES PRODUCTION.PRODUCT_CATEGORY(PRODUCT_CATEGORYID)
);
-- 插入 PRODUCT_CATEGORY 数据
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (1, '小说');
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (2, '文学');
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (3, '计算机');
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (4, '英语');
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (5, '管理');
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (6, '少儿');
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (7, '金融');
-- 插入 PRODUCT_SUBCATEGORY 数据
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (1, 1, '世界名著');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (2, 1, '武侠');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (3, 1, '科幻');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (4, 1, '四大名著');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (5, 1, '军事');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (6, 1, '社会');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (7, 2, '文集');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (8, 2, '纪实文学');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (9, 2, '文学理论');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (10, 2, '中国古诗词');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (11, 2, '中国现当代诗');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (12, 2, '戏剧');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (13, 2, '民间文学');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (14, 3, '计算机理论');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (15, 3, '计算机体系结构');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (16, 3, '操作系统');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (17, 3, '程序设计');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (18, 3, '数据库');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (19, 3, '软件工程');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (20, 3, '信息安全');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (21, 3, '多媒体');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (22, 4, '英语词汇');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (23, 4, '英语语法');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (24, 4, '英语听力');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (25, 4, '英语口语');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (26, 4, '英语阅读');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (27, 4, '英语写作');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (28, 5, '行政管理');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (29, 5, '项目管理');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (30, 5, '质量管理与控制');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (31, 5, '商业道德');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (32, 5, '经营管理');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (33, 5, '财务管理');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (34, 6, '幼儿启蒙');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (35, 6, '益智游戏');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (36, 6, '童话');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (37, 6, '卡通');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (38, 6, '励志');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (39, 6, '少儿英语');
-- 测试用例 1: 查询所有类别及其子类别的名称
SELECT T1.NAME AS CategoryName, T2.NAME AS SubCategoryName
FROM PRODUCTION.PRODUCT_CATEGORY T1
INNER JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID;
-- 测试用例 2: 查询特定类别（计算机）及其子类别的名称
SELECT T1.NAME AS CategoryName, T2.NAME AS SubCategoryName
FROM PRODUCTION.PRODUCT_CATEGORY T1
INNER JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID
WHERE T1.NAME = '计算机';
-- 测试用例 3: 查询没有子类别的类别（金融）
SELECT T1.NAME AS CategoryName
FROM PRODUCTION.PRODUCT_CATEGORY T1
LEFT JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID
WHERE T2.PRODUCT_SUBCATEGORYID IS NULL;
-- 测试用例 4: 查询特定子类别（数据库）及其所属类别的名称
SELECT T1.NAME AS CategoryName, T2.NAME AS SubCategoryName
FROM PRODUCTION.PRODUCT_CATEGORY T1
INNER JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID
WHERE T2.NAME = '数据库';
-- 测试用例 5: 查询所有类别及其子类别的数量
SELECT T1.NAME AS CategoryName, COUNT(T2.PRODUCT_SUBCATEGORYID) AS SubCategoryCount
FROM PRODUCTION.PRODUCT_CATEGORY T1
LEFT JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID
GROUP BY T1.NAME;
-- 测试用例 6: 查询子类别数量最多的类别
SELECT T1.NAME AS CategoryName, COUNT(T2.PRODUCT_SUBCATEGORYID) AS SubCategoryCount
FROM PRODUCTION.PRODUCT_CATEGORY T1
LEFT JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID
GROUP BY T1.NAME
ORDER BY SubCategoryCount DESC
LIMIT 1;
-- 测试用例 7: 查询子类别数量最少的类别
SELECT T1.NAME AS CategoryName, COUNT(T2.PRODUCT_SUBCATEGORYID) AS SubCategoryCount
FROM PRODUCTION.PRODUCT_CATEGORY T1
LEFT JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID
GROUP BY T1.NAME
ORDER BY SubCategoryCount ASC
LIMIT 1;
-- 测试用例 8: 查询所有类别及其子类别的名称，按类别名称排序
SELECT T1.NAME AS CategoryName, T2.NAME AS SubCategoryName
FROM PRODUCTION.PRODUCT_CATEGORY T1
INNER JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID
ORDER BY T1.NAME;
-- 测试用例 9: 查询所有类别及其子类别的名称，按子类别名称排序
SELECT T1.NAME AS CategoryName, T2.NAME AS SubCategoryName
FROM PRODUCTION.PRODUCT_CATEGORY T1
INNER JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID
ORDER BY T2.NAME;
-- 测试用例 10: 查询所有类别及其子类别的名称，按类别名称和子类别名称排序
SELECT T1.NAME AS CategoryName, T2.NAME AS SubCategoryName
FROM PRODUCTION.PRODUCT_CATEGORY T1
INNER JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID
ORDER BY T1.NAME, T2.NAME