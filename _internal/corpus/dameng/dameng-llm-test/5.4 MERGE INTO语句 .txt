-- 公共前置语句：创建表T1和T2
DROP TABLE IF EXISTS T1;
DROP TABLE IF EXISTS T2;
CREATE TABLE T1 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T2 (C3 INT, C4 VARCHAR(20));
INSERT INTO T1 VALUES(1,'T1_1');
INSERT INTO T1 VALUES(2,'T1_2');
INSERT INTO T1 VALUES(3,'T1_3');
INSERT INTO T2 VALUES(2,'T2_2');
INSERT INTO T2 VALUES(4,'T2_4');
COMMIT;
-- 测试用例1：基本MERGE INTO语句，更新匹配的记录并插入不匹配的记录
MERGE INTO T1 USING T2 ON (T1.C1 = T2.C3)
WHEN MATCHED THEN UPDATE SET T1.C2 = T2.C4
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T2.C3, T2.C4);
-- 测试用例2：MERGE INTO语句，带WHERE条件的UPDATE和DELETE子句
MERGE INTO T1 USING T2 ON (T1.C1 = T2.C3)
WHEN MATCHED THEN UPDATE SET T1.C2 = T2.C4 WHERE T1.C1 >= 2 DELETE WHERE T1.C1 = 4
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T2.C3, T2.C4);
-- 公共前置语句：创建表T3和T4
DROP TABLE IF EXISTS T3;
DROP TABLE IF EXISTS T4;
CREATE TABLE T3 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T4 (C3 INT, C4 VARCHAR(20));
INSERT INTO T3 VALUES(1,'T3_1');
INSERT INTO T3 VALUES(2,'T3_2');
INSERT INTO T3 VALUES(3,'T3_3');
INSERT INTO T4 VALUES(2,'T4_2');
INSERT INTO T4 VALUES(4,'T4_4');
COMMIT;
-- 测试用例3：MERGE INTO语句，仅更新匹配的记录
MERGE INTO T3 USING T4 ON (T3.C1 = T4.C3)
WHEN MATCHED THEN UPDATE SET T3.C2 = T4.C4;
-- 测试用例4：MERGE INTO语句，仅插入不匹配的记录
MERGE INTO T3 USING T4 ON (T3.C1 = T4.C3)
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T4.C3, T4.C4);
-- 公共前置语句：创建表T5和T6
DROP TABLE IF EXISTS T5;
DROP TABLE IF EXISTS T6;
CREATE TABLE T5 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T6 (C3 INT, C4 VARCHAR(20));
INSERT INTO T5 VALUES(1,'T5_1');
INSERT INTO T5 VALUES(2,'T5_2');
INSERT INTO T5 VALUES(3,'T5_3');
INSERT INTO T6 VALUES(2,'T6_2');
INSERT INTO T6 VALUES(4,'T6_4');
COMMIT;
-- 测试用例5：MERGE INTO语句，带WHERE条件的UPDATE子句
MERGE INTO T5 USING T6 ON (T5.C1 = T6.C3)
WHEN MATCHED THEN UPDATE SET T5.C2 = T6.C4 WHERE T5.C1 >= 2
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T6.C3, T6.C4);
-- 测试用例6：MERGE INTO语句，带WHERE条件的DELETE子句
MERGE INTO T5 USING T6 ON (T5.C1 = T6.C3)
WHEN MATCHED THEN UPDATE SET T5.C2 = T6.C4 DELETE WHERE T5.C1 = 4
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T6.C3, T6.C4);
-- 公共前置语句：创建表T7和T8
DROP TABLE IF EXISTS T7;
DROP TABLE IF EXISTS T8;
CREATE TABLE T7 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T8 (C3 INT, C4 VARCHAR(20));
INSERT INTO T7 VALUES(1,'T7_1');
INSERT INTO T7 VALUES(2,'T7_2');
INSERT INTO T7 VALUES(3,'T7_3');
INSERT INTO T8 VALUES(2,'T8_2');
INSERT INTO T8 VALUES(4,'T8_4');
COMMIT;
-- 测试用例7：MERGE INTO语句，仅更新匹配的记录，不带WHERE条件
MERGE INTO T7 USING T8 ON (T7.C1 = T8.C3)
WHEN MATCHED THEN UPDATE SET T7.C2 = T8.C4;
-- 测试用例8：MERGE INTO语句，仅插入不匹配的记录，不带WHERE条件
MERGE INTO T7 USING T8 ON (T7.C1 = T8.C3)
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T8.C3, T8.C4);
-- 公共前置语句：创建表T9和T10
DROP TABLE IF EXISTS T9;
DROP TABLE IF EXISTS T10;
CREATE TABLE T9 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T10 (C3 INT, C4 VARCHAR(20));
INSERT INTO T9 VALUES(1,'T9_1');
INSERT INTO T9 VALUES(2,'T9_2');
INSERT INTO T9 VALUES(3,'T9_3');
INSERT INTO T10 VALUES(2,'T10_2');
INSERT INTO T10 VALUES(4,'T10_4');
COMMIT;
-- 测试用例9：MERGE INTO语句，带WHERE条件的UPDATE和DELETE子句
MERGE INTO T9 USING T10 ON (T9.C1 = T10.C3)
WHEN MATCHED THEN UPDATE SET T9.C2 = T10.C4 WHERE T9.C1 >= 2 DELETE WHERE T9.C1 = 4
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T10.C3, T10.C4);
-- 测试用例10：MERGE INTO语句，仅更新匹配的记录，带WHERE条件
MERGE INTO T9 USING T10 ON (T9.C1 = T10.C3)
WHEN MATCHED THEN UPDATE SET T9.C2 = T10.C4 WHERE T9.C1 >= 2;
-- 公共前置语句：创建表T11和T12
DROP TABLE IF EXISTS T11;
DROP TABLE IF EXISTS T12;
CREATE TABLE T11 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T12 (C3 INT, C4 VARCHAR(20));
INSERT INTO T11 VALUES(1,'T11_1');
INSERT INTO T11 VALUES(2,'T11_2');
INSERT INTO T11 VALUES(3,'T11_3');
INSERT INTO T12 VALUES(2,'T12_2');
INSERT INTO T12 VALUES(4,'T12_4');
COMMIT;
-- 测试用例11：MERGE INTO语句，仅插入不匹配的记录，带WHERE条件
MERGE INTO T11 USING T12 ON (T11.C1 = T12.C3)
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T12.C3, T12.C4) WHERE T12.C3 = 4;
-- 测试用例12：MERGE INTO语句，带WHERE条件的UPDATE和DELETE子句
MERGE INTO T11 USING T12 ON (T11.C1 = T12.C3)
WHEN MATCHED THEN UPDATE SET T11.C2 = T12.C4 WHERE T11.C1 >= 2 DELETE WHERE T11.C1 = 4
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T12.C3, T12.C4);
-- 公共前置语句：创建表T13和T14
DROP TABLE IF EXISTS T13;
DROP TABLE IF EXISTS T14;
CREATE TABLE T13 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T14 (C3 INT, C4 VARCHAR(20));
INSERT INTO T13 VALUES(1,'T13_1');
INSERT INTO T13 VALUES(2,'T13_2');
INSERT INTO T13 VALUES(3,'T13_3');
INSERT INTO T14 VALUES(2,'T14_2');
INSERT INTO T14 VALUES(4,'T14_4');
COMMIT;
-- 测试用例13：MERGE INTO语句，仅更新匹配的记录，不带WHERE条件
MERGE INTO T13 USING T14 ON (T13.C1 = T14.C3)
WHEN MATCHED THEN UPDATE SET T13.C2 = T14.C4;
-- 测试用例14：MERGE INTO语句，仅插入不匹配的记录，不带WHERE条件
MERGE INTO T13 USING T14 ON (T13.C1 = T14.C3)
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T14.C3, T14.C4);
-- 公共前置语句：创建表T15和T16
DROP TABLE IF EXISTS T15;
DROP TABLE IF EXISTS T16;
CREATE TABLE T15 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T16 (C3 INT, C4 VARCHAR(20));
INSERT INTO T15 VALUES(1,'T15_1');
INSERT INTO T15 VALUES(2,'T15_2');
INSERT INTO T15 VALUES(3,'T15_3');
INSERT INTO T16 VALUES(2,'T16_2');
INSERT INTO T16 VALUES(4,'T16_4');
COMMIT;
-- 测试用例15：MERGE INTO语句，带WHERE条件的UPDATE和DELETE子句
MERGE INTO T15 USING T16 ON (T15.C1 = T16.C3)
WHEN MATCHED THEN UPDATE SET T15.C2 = T16.C4 WHERE T15.C1 >= 2 DELETE WHERE T15.C1 = 4
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T16.C3, T16.C4);
-- 测试用例16：MERGE INTO语句，仅更新匹配的记录，带WHERE条件
MERGE INTO T15 USING T16 ON (T15.C1 = T16.C3)
WHEN MATCHED THEN UPDATE SET T15.C2 = T16.C4 WHERE T15.C1 >= 2;
-- 公共前置语句：创建表T17和T18
DROP TABLE IF EXISTS T17;
DROP TABLE IF EXISTS T18;
CREATE TABLE T17 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T18 (C3 INT, C4 VARCHAR(20));
INSERT INTO T17 VALUES(1,'T17_1');
INSERT INTO T17 VALUES(2,'T17_2');
INSERT INTO T17 VALUES(3,'T17_3');
INSERT INTO T18 VALUES(2,'T18_2');
INSERT INTO T18 VALUES(4,'T18_4');
COMMIT;
-- 测试用例17：MERGE INTO语句，仅插入不匹配的记录，带WHERE条件
MERGE INTO T17 USING T18 ON (T17.C1 = T18.C3)
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T18.C3, T18.C4) WHERE T18.C3 = 4;
-- 测试用例18：MERGE INTO语句，带WHERE条件的UPDATE和DELETE子句
MERGE INTO T17 USING T18 ON (T17.C1 = T18.C3)
WHEN MATCHED THEN UPDATE SET T17.C2 = T18.C4 WHERE T17.C1 >= 2 DELETE WHERE T17.C1 = 4
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T18.C3, T18.C4);
-- 公共前置语句：创建表T19和T20
DROP TABLE IF EXISTS T19;
DROP TABLE IF EXISTS T20;
CREATE TABLE T19 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T20 (C3 INT, C4 VARCHAR(20));
INSERT INTO T19 VALUES(1,'T19_1');
INSERT INTO T19 VALUES(2,'T19_2');
INSERT INTO T19 VALUES(3,'T19_3');
INSERT INTO T20 VALUES(2,'T20_2');
INSERT INTO T20 VALUES(4,'T20_4');
COMMIT;
-- 测试用例19：MERGE INTO语句，仅更新匹配的记录，不带WHERE条件
MERGE INTO T19 USING T20 ON (T19.C1 = T20.C3)
WHEN MATCHED THEN UPDATE SET T19.C2 = T20.C4;
-- 测试用例20：MERGE INTO语句，仅插入不匹配的记录，不带WHERE条件
MERGE INTO T19 USING T20 ON (T19.C1 = T20.C3)
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T20.C3, T20.C4);
-- 公共前置语句：创建表T21和T22
DROP TABLE IF EXISTS T21;
DROP TABLE IF EXISTS T22;
CREATE TABLE T21 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T22 (C3 INT, C4 VARCHAR(20));
INSERT INTO T21 VALUES(1,'T21_1');
INSERT INTO T21 VALUES(2,'T21_2');
INSERT INTO T21 VALUES(3,'T21_3');
INSERT INTO T22 VALUES(2,'T22_2');
INSERT INTO T22 VALUES(4,'T22_4');
COMMIT;
-- 测试用例21：MERGE INTO语句，带WHERE条件的UPDATE和DELETE子句
MERGE INTO T21 USING T22 ON (T21.C1 = T22.C3)
WHEN MATCHED THEN UPDATE SET T21.C2 = T22.C4 WHERE T21.C1 >= 2 DELETE WHERE T21.C1 = 4
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T22.C3, T22.C4);
-- 测试用例22：MERGE INTO语句，仅更新匹配的记录，带WHERE条件
MERGE INTO T21 USING T22 ON (T21.C1 = T22.C3)
WHEN MATCHED THEN UPDATE SET T21.C2 = T22.C4 WHERE T21.C1 >= 2;
-- 公共前置语句：创建表T23和T24
DROP TABLE IF EXISTS T23;
DROP TABLE IF EXISTS T24;
CREATE TABLE T23 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T24 (C3 INT, C4 VARCHAR(20));
INSERT INTO T23 VALUES(1,'T23_1');
INSERT INTO T23 VALUES(2,'T23_2');
INSERT INTO T23 VALUES(3,'T23_3');
INSERT INTO T24 VALUES(2,'T24_2');
INSERT INTO T24 VALUES(4,'T24_4');
COMMIT;
-- 测试用例23：MERGE INTO语句，仅插入不匹配的记录，带WHERE条件
MERGE INTO T23 USING T24 ON (T23.C1 = T24.C3)
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T24.C3, T24.C4) WHERE T24.C3 = 4;
-- 测试用例24：MERGE INTO语句，带WHERE条件的UPDATE和DELETE子句
MERGE INTO T23 USING T24 ON (T23.C1 = T24.C3)
WHEN MATCHED THEN UPDATE SET T23.C2 = T24.C4 WHERE T23.C1 >= 2 DELETE WHERE T23.C1 = 4
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T24.C3, T24.C4);
-- 公共前置语句：创建表T25和T26
DROP TABLE IF EXISTS T25;
DROP TABLE IF EXISTS T26;
CREATE TABLE T25 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T26 (C3 INT, C4 VARCHAR(20));
INSERT INTO T25 VALUES(1,'T25_1');
INSERT INTO T25 VALUES(2,'T25_2');
INSERT INTO T25 VALUES(3,'T25_3');
INSERT INTO T26 VALUES(2,'T26_2');
INSERT INTO T26 VALUES(4,'T26_4');
COMMIT;
-- 测试用例25：MERGE INTO语句，仅更新匹配的记录，不带WHERE条件
MERGE INTO T25 USING T26 ON (T25.C1 = T26.C3)
WHEN MATCHED THEN UPDATE SET T25.C2 = T26.C4;
-- 测试用例26：MERGE INTO语句，仅插入不匹配的记录，不带WHERE条件
MERGE INTO T25 USING T26 ON (T25.C1 = T26.C3)
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T26.C3, T26.C4);
-- 公共前置语句：创建表T27和T28
DROP TABLE IF EXISTS T27;
DROP TABLE IF EXISTS T28;
CREATE TABLE T27 (C1 INT, C2 VARCHAR(20));
CREATE TABLE T28 (C3 INT, C4 VARCHAR(20));
INSERT INTO T27 VALUES(1,'T27_1');
INSERT INTO T27 VALUES(2,'T27_2');
INSERT INTO T27 VALUES(3,'T27_3');
INSERT INTO T28 VALUES(2,'T28_2');
INSERT INTO T28 VALUES(4,'T28_4');
COMMIT;
-- 测试用例27：MERGE INTO语句，带WHERE条件的UPDATE和DELETE子句
MERGE INTO T27 USING T28 ON (T27.C1 = T28.C3)
WHEN MATCHED THEN UPDATE SET T27.C2 = T28.C4 WHERE T27.C1 >= 2 DELETE WHERE T27.C1 = 4
WHEN NOT MATCHED THEN INSERT (C1, C2) VALUES(T28.C3, T28.C4)