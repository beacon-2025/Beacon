-- 创建员工地址表
CREATE TABLE PERSON.ADDRESS (
    CITY VARCHAR(50),
    ADDRESS1 VARCHAR(100)
);
-- 插入测试数据
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区369号金地太阳城56-1-202');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区369号金地太阳城57-2-302');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区保利花园50-1-304');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区保利花园51-1-702');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区关山春晓51-1-702');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区关山春晓55-1-202');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区关山春晓10-1-202');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区关山春晓11-1-202');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区光谷软件园C1_501');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市青山区', '青山区青翠苑1号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市武昌区', '武昌区武船新村115号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市武昌区', '武昌区武船新村1号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市汉阳区', '汉阳大道熊家湾15号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市江汉区', '江汉区发展大道561号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市江汉区', '江汉区发展大道555号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市江汉区', '江汉区发展大道423号');
-- 查询使用GROUP_ID
SELECT GROUPING(CITY) AS G_CITY, GROUPING(ADDRESS1) AS G_ADD, GROUP_ID() AS GID, CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY ROLLUP(CITY, ADDRESS1), CITY;
-- 插入测试数据
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('北京市朝阳区', '朝阳区望京SOHO');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('北京市朝阳区', '朝阳区国贸大厦');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('北京市海淀区', '海淀区中关村大街');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('北京市海淀区', '海淀区清华园');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('上海市浦东新区', '浦东新区陆家嘴');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('上海市浦东新区', '浦东新区张江高科');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('上海市徐汇区', '徐汇区漕河泾');
-- 查询使用GROUP_ID
SELECT GROUPING(CITY) AS G_CITY, GROUPING(ADDRESS1) AS G_ADD, GROUP_ID() AS GID, CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY ROLLUP(CITY, ADDRESS1), CITY;
-- 插入测试数据
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('广州市天河区', '天河区珠江新城');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('广州市天河区', '天河区体育西路');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('广州市越秀区', '越秀区北京路');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('广州市越秀区', '越秀区中山五路');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('深圳市南山区', '南山区科技园');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('深圳市南山区', '南山区蛇口');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('深圳市福田区', '福田区华强北');
-- 查询使用GROUP_ID进行表达式运算
SELECT GROUPING(CITY) AS G_CITY, GROUPING(ADDRESS1) AS G_ADD, GROUP_ID() + 1 AS GID, CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY ROLLUP(CITY, ADDRESS1), CITY;
-- 插入测试数据
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('成都市武侯区', '武侯区天府软件园');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('成都市武侯区', '武侯区红牌楼');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('成都市高新区', '高新区天府三街');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('成都市高新区', '高新区天府五街');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('重庆市渝中区', '渝中区解放碑');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('重庆市渝中区', '渝中区朝天门');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('重庆市江北区', '江北区观音桥');
-- 查询使用GROUP_ID过滤相同分组
SELECT GROUPING(CITY) AS G_CITY, GROUPING(ADDRESS1) AS G_ADD, GROUP_ID() AS GID, CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY ROLLUP(CITY, ADDRESS1), CITY
HAVING GROUP_ID() = 0;
-- 创建员工信息表
CREATE TABLE PERSON.EMPLOYEE (
    EMPLOYEE_ID INT,
    NAME VARCHAR(50),
    CITY VARCHAR(50)
);
-- 插入测试数据
INSERT INTO PERSON.EMPLOYEE (EMPLOYEE_ID, NAME, CITY) VALUES (1, '张三', '武汉市洪山区');
INSERT INTO PERSON.EMPLOYEE (EMPLOYEE_ID, NAME, CITY) VALUES (2, '李四', '武汉市洪山区');
INSERT INTO PERSON.EMPLOYEE (EMPLOYEE_ID, NAME, CITY) VALUES (3, '王五', '武汉市青山区');
INSERT INTO PERSON.EMPLOYEE (EMPLOYEE_ID, NAME, CITY) VALUES (4, '赵六', '武汉市武昌区');
INSERT INTO PERSON.EMPLOYEE (EMPLOYEE_ID, NAME, CITY) VALUES (5, '孙七', '武汉市汉阳区');
INSERT INTO PERSON.EMPLOYEE (EMPLOYEE_ID, NAME, CITY) VALUES (6, '周八', '武汉市江汉区');
-- 查询使用GROUP_ID进行多表连接
SELECT GROUPING(E.CITY) AS G_CITY, GROUPING(A.ADDRESS1) AS G_ADD, GROUP_ID() AS GID, E.CITY, A.ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.EMPLOYEE E
JOIN PERSON.ADDRESS A ON E.CITY = A.CITY
GROUP BY ROLLUP(E.CITY, A.ADDRESS1), E.CITY