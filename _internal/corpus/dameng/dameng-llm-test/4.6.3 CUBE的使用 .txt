-- 创建表 PERSON.ADDRESS
CREATE TABLE PERSON.ADDRESS (
    CITY VARCHAR(50),
    ADDRESS1 VARCHAR(100)
);
-- 插入测试数据
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区 369号金地太阳城 56-1-202');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区 369号金地太阳城 57-2-302');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区保利花园 50-1-304');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区保利花园 51-1-702');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区关山春晓 51-1-702');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区关山春晓 55-1-202');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区关山春晓 10-1-202');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区关山春晓 11-1-202');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市洪山区', '洪山区光谷软件园 C1_501');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市青山区', '青山区青翠苑 1号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市武昌区', '武昌区武船新村 115号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市武昌区', '武昌区武船新村 1号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市汉阳区', '汉阳大道熊家湾 15号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市江汉区', '江汉区发展大道 561号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市江汉区', '江汉区发展大道 555号');
INSERT INTO PERSON.ADDRESS (CITY, ADDRESS1) VALUES ('武汉市江汉区', '江汉区发展大道 423号');
-- 使用CUBE对CITY和ADDRESS1进行分组统计
SELECT CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY CUBE(CITY, ADDRESS1);
-- 使用CUBE对CITY进行分组统计
SELECT CITY, NULL AS ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY CUBE(CITY);
-- 使用CUBE对ADDRESS1进行分组统计
SELECT NULL AS CITY, ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY CUBE(ADDRESS1);
-- 使用CUBE对全表进行统计
SELECT NULL AS CITY, NULL AS ADDRESS1, COUNT(*) AS NUMS
FROM PERSON.ADDRESS
GROUP BY CUBE();
-- 创建新表并插入数据
CREATE TABLE PERSON.EMPLOYEE (
    CITY VARCHAR(50),
    ADDRESS1 VARCHAR(100),
    DEPARTMENT VARCHAR(50)
);
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市洪山区', '洪山区 369号金地太阳城 56-1-202', '研发部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市洪山区', '洪山区 369号金地太阳城 57-2-302', '市场部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市洪山区', '洪山区保利花园 50-1-304', '财务部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市洪山区', '洪山区保利花园 51-1-702', '人力资源部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市洪山区', '洪山区关山春晓 51-1-702', '研发部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市洪山区', '洪山区关山春晓 55-1-202', '市场部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市洪山区', '洪山区关山春晓 10-1-202', '财务部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市洪山区', '洪山区关山春晓 11-1-202', '人力资源部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市洪山区', '洪山区光谷软件园 C1_501', '研发部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市青山区', '青山区青翠苑 1号', '市场部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市武昌区', '武昌区武船新村 115号', '财务部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市武昌区', '武昌区武船新村 1号', '人力资源部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市汉阳区', '汉阳大道熊家湾 15号', '研发部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市江汉区', '江汉区发展大道 561号', '市场部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市江汉区', '江汉区发展大道 555号', '财务部');
INSERT INTO PERSON.EMPLOYEE (CITY, ADDRESS1, DEPARTMENT) VALUES ('武汉市江汉区', '江汉区发展大道 423号', '人力资源部');
-- 使用CUBE对CITY, ADDRESS1, DEPARTMENT进行分组统计
SELECT CITY, ADDRESS1, DEPARTMENT, COUNT(*) AS NUMS
FROM PERSON.EMPLOYEE
GROUP BY CUBE(CITY, ADDRESS1, DEPARTMENT);
-- 创建新表并插入数据
CREATE TABLE PERSON.STUDENT (
    CITY VARCHAR(50),
    ADDRESS1 VARCHAR(100),
    DEPARTMENT VARCHAR(50),
    GRADE VARCHAR(50)
);
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市洪山区', '洪山区 369号金地太阳城 56-1-202', '计算机科学', '大一');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市洪山区', '洪山区 369号金地太阳城 57-2-302', '数学', '大二');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市洪山区', '洪山区保利花园 50-1-304', '物理', '大三');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市洪山区', '洪山区保利花园 51-1-702', '化学', '大四');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市洪山区', '洪山区关山春晓 51-1-702', '计算机科学', '大一');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市洪山区', '洪山区关山春晓 55-1-202', '数学', '大二');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市洪山区', '洪山区关山春晓 10-1-202', '物理', '大三');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市洪山区', '洪山区关山春晓 11-1-202', '化学', '大四');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市洪山区', '洪山区光谷软件园 C1_501', '计算机科学', '大一');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市青山区', '青山区青翠苑 1号', '数学', '大二');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市武昌区', '武昌区武船新村 115号', '物理', '大三');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市武昌区', '武昌区武船新村 1号', '化学', '大四');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市汉阳区', '汉阳大道熊家湾 15号', '计算机科学', '大一');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市江汉区', '江汉区发展大道 561号', '数学', '大二');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市江汉区', '江汉区发展大道 555号', '物理', '大三');
INSERT INTO PERSON.STUDENT (CITY, ADDRESS1, DEPARTMENT, GRADE) VALUES ('武汉市江汉区', '江汉区发展大道 423号', '化学', '大四');
-- 使用CUBE对CITY, ADDRESS1, DEPARTMENT, GRADE进行分组统计
SELECT CITY, ADDRESS1, DEPARTMENT, GRADE, COUNT(*) AS NUMS
FROM PERSON.STUDENT
GROUP BY CUBE(CITY, ADDRESS1, DEPARTMENT, GRADE);
-- 创建新表并插入数据
CREATE TABLE PERSON.TEACHER (
    CITY VARCHAR(50),
    ADDRESS1 VARCHAR(100),
    DEPARTMENT VARCHAR(50),
    GRADE VARCHAR(50),
    SUBJECT VARCHAR(50)
);
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市洪山区', '洪山区 369号金地太阳城 56-1-202', '计算机科学', '大一', '数据结构');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市洪山区', '洪山区 369号金地太阳城 57-2-302', '数学', '大二', '高等数学');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市洪山区', '洪山区保利花园 50-1-304', '物理', '大三', '量子力学');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市洪山区', '洪山区保利花园 51-1-702', '化学', '大四', '有机化学');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市洪山区', '洪山区关山春晓 51-1-702', '计算机科学', '大一', '算法设计');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市洪山区', '洪山区关山春晓 55-1-202', '数学', '大二', '线性代数');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市洪山区', '洪山区关山春晓 10-1-202', '物理', '大三', '热力学');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市洪山区', '洪山区关山春晓 11-1-202', '化学', '大四', '无机化学');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市洪山区', '洪山区光谷软件园 C1_501', '计算机科学', '大一', '数据库原理');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市青山区', '青山区青翠苑 1号', '数学', '大二', '概率论');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市武昌区', '武昌区武船新村 115号', '物理', '大三', '电磁学');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市武昌区', '武昌区武船新村 1号', '化学', '大四', '分析化学');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市汉阳区', '汉阳大道熊家湾 15号', '计算机科学', '大一', '操作系统');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市江汉区', '江汉区发展大道 561号', '数学', '大二', '离散数学');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市江汉区', '江汉区发展大道 555号', '物理', '大三', '光学');
INSERT INTO PERSON.TEACHER (CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT) VALUES ('武汉市江汉区', '江汉区发展大道 423号', '化学', '大四', '物理化学');
-- 使用CUBE对CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT进行分组统计
SELECT CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT, COUNT(*) AS NUMS
FROM PERSON.TEACHER
GROUP BY CUBE(CITY, ADDRESS1, DEPARTMENT, GRADE, SUBJECT)