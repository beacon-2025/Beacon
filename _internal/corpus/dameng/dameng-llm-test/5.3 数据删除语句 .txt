-- 创建模式
CREATE SCHEMA RESOURCES;
-- 创建基表 EMPLOYEE
CREATE TABLE RESOURCES.EMPLOYEE (
    EMPLOYEEID INT PRIMARY KEY,
    NAME VARCHAR(50)
);
-- 创建基表 EMPLOYEE_DEPARTMENT
CREATE TABLE RESOURCES.EMPLOYEE_DEPARTMENT (
    EMPLOYEEID INT PRIMARY KEY,
    DEPARTMENTID INT
);
-- 创建基表 EMPLOYEE_ADDRESS
CREATE TABLE RESOURCES.EMPLOYEE_ADDRESS (
    EMPLOYEEID INT PRIMARY KEY,
    ADDRESS VARCHAR(100)
);
-- 插入测试数据到 EMPLOYEE 表
INSERT INTO RESOURCES.EMPLOYEE (EMPLOYEEID, NAME) VALUES (1, 'Alice');
INSERT INTO RESOURCES.EMPLOYEE (EMPLOYEEID, NAME) VALUES (2, 'Bob');
INSERT INTO RESOURCES.EMPLOYEE (EMPLOYEEID, NAME) VALUES (3, 'Charlie');
-- 插入测试数据到 EMPLOYEE_DEPARTMENT 表
INSERT INTO RESOURCES.EMPLOYEE_DEPARTMENT (EMPLOYEEID, DEPARTMENTID) VALUES (1, 101);
INSERT INTO RESOURCES.EMPLOYEE_DEPARTMENT (EMPLOYEEID, DEPARTMENTID) VALUES (2, 102);
-- 插入测试数据到 EMPLOYEE_ADDRESS 表
INSERT INTO RESOURCES.EMPLOYEE_ADDRESS (EMPLOYEEID, ADDRESS) VALUES (1, '123 Main St');
INSERT INTO RESOURCES.EMPLOYEE_ADDRESS (EMPLOYEEID, ADDRESS) VALUES (2, '456 Elm St');
INSERT INTO RESOURCES.EMPLOYEE_ADDRESS (EMPLOYEEID, ADDRESS) VALUES (3, '789 Oak St');
-- 测试用例 1: 删除表中所有数据
DELETE FROM RESOURCES.EMPLOYEE_ADDRESS;
-- 测试用例 2: 删除满足条件的记录
DELETE FROM RESOURCES.EMPLOYEE_ADDRESS WHERE EMPLOYEEID = 3;
-- 测试用例 3: 使用子查询删除记录
DELETE FROM RESOURCES.EMPLOYEE_ADDRESS
WHERE EMPLOYEEID IN (
    SELECT EMPLOYEEID
    FROM RESOURCES.EMPLOYEE
    WHERE EMPLOYEEID NOT IN (
        SELECT EMPLOYEEID
        FROM RESOURCES.EMPLOYEE_DEPARTMENT
    )
);
-- 测试用例 4: 删除记录并返回删除的列到变量
DECLARE @deleted_address VARCHAR(100);
DELETE FROM RESOURCES.EMPLOYEE_ADDRESS
WHERE EMPLOYEEID = 1
RETURN ADDRESS INTO @deleted_address;
-- 测试用例 5: 删除记录并返回删除的列到数组
DECLARE @deleted_addresses VARCHAR(100)[];
DELETE FROM RESOURCES.EMPLOYEE_ADDRESS
WHERE EMPLOYEEID IN (1, 2)
RETURN ADDRESS INTO @deleted_addresses;
-- 测试用例 6: 删除视图中的数据
CREATE VIEW RESOURCES.EMPLOYEE_VIEW AS
SELECT EMPLOYEEID, ADDRESS
FROM RESOURCES.EMPLOYEE_ADDRESS;
DELETE FROM RESOURCES.EMPLOYEE_VIEW WHERE EMPLOYEEID = 2;
-- 测试用例 7: 删除子查询表达式中的记录
DELETE FROM (SELECT EMPLOYEEID, ADDRESS FROM RESOURCES.EMPLOYEE_ADDRESS) AS SUBQUERY
WHERE EMPLOYEEID = 3;
-- 测试用例 8: 删除记录并返回多个列到变量
DECLARE @deleted_employeeid INT;
DECLARE @deleted_address VARCHAR(100);
DELETE FROM RESOURCES.EMPLOYEE_ADDRESS
WHERE EMPLOYEEID = 1
RETURN EMPLOYEEID, ADDRESS INTO @deleted_employeeid, @deleted_address;
-- 测试用例 9: 删除记录并返回多个列到数组
DECLARE @deleted_employeeids INT[];
DECLARE @deleted_addresses VARCHAR(100)[];
DELETE FROM RESOURCES.EMPLOYEE_ADDRESS
WHERE EMPLOYEEID IN (1, 2)
RETURN EMPLOYEEID, ADDRESS INTO @deleted_employeeids, @deleted_addresses;
-- 测试用例 10: 删除记录并返回列到记录数组
DECLARE @deleted_records RECORD (EMPLOYEEID INT, ADDRESS VARCHAR(100));
DELETE FROM RESOURCES.EMPLOYEE_ADDRESS
WHERE EMPLOYEEID = 1
RETURN EMPLOYEEID, ADDRESS INTO @deleted_records