-- 公共前置语句：创建表和插入数据
CREATE TABLE PRODUCTION.PRODUCT_CATEGORY (
    PRODUCT_CATEGORYID INT PRIMARY KEY,
    NAME VARCHAR(50)
);
CREATE TABLE PRODUCTION.PRODUCT_SUBCATEGORY (
    PRODUCT_SUBCATEGORYID INT PRIMARY KEY,
    PRODUCT_CATEGORYID INT,
    NAME VARCHAR(50)
);
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (1, '小说');
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (2, '文学');
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (3, '计算机');
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (4, '英语');
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (5, '管理');
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (6, '少儿');
INSERT INTO PRODUCTION.PRODUCT_CATEGORY (PRODUCT_CATEGORYID, NAME) VALUES (7, '金融');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (1, 1, '世界名著');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (2, 1, '武侠');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (3, 1, '科幻');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (4, 1, '四大名著');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (5, 1, '军事');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (6, 1, '社会');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (7, 2, '文集');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (8, 2, '纪实文学');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (9, 2, '文学理论');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (10, 2, '中国古诗词');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (11, 2, '中国现当代诗');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (12, 2, '戏剧');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (13, 2, '民间文学');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (14, 3, '计算机理论');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (15, 3, '计算机体系结构');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (16, 3, '操作系统');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (17, 3, '程序设计');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (18, 3, '数据库');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (19, 3, '软件工程');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (20, 3, '信息安全');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (21, 3, '多媒体');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (22, 4, '英语词汇');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (23, 4, '英语语法');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (24, 4, '英语听力');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (25, 4, '英语口语');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (26, 4, '英语阅读');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (27, 4, '英语写作');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (28, 5, '行政管理');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (29, 5, '项目管理');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (30, 5, '质量管理与控制');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (31, 5, '商业道德');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (32, 5, '经营管理');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (33, 5, '财务管理');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (34, 6, '幼儿启蒙');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (35, 6, '益智游戏');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (36, 6, '童话');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (37, 6, '卡通');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (38, 6, '励志');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (39, 6, '少儿英语');
INSERT INTO PRODUCTION.PRODUCT_SUBCATEGORY (PRODUCT_SUBCATEGORYID, PRODUCT_CATEGORYID, NAME) VALUES (40, 7, '历史');
-- 测试用例 1: 左外连接
SELECT T1.NAME, T2.NAME 
FROM PRODUCTION.PRODUCT_CATEGORY T1 
LEFT OUTER JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2 
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID;
-- 测试用例 2: 右外连接
SELECT T1.NAME, T2.NAME 
FROM PRODUCTION.PRODUCT_CATEGORY T1 
RIGHT OUTER JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2 
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID;
-- 测试用例 3: 全外连接
SELECT T1.NAME, T2.NAME 
FROM PRODUCTION.PRODUCT_CATEGORY T1 
FULL OUTER JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2 
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID;
-- 测试用例 4: 使用 (+) 表示左外连接
SELECT T1.NAME, T2.NAME 
FROM PRODUCTION.PRODUCT_CATEGORY T1, PRODUCTION.PRODUCT_SUBCATEGORY T2 
WHERE T1.PRODUCT_CATEGORYID(+) = T2.PRODUCT_CATEGORYID;
-- 测试用例 5: 使用 (+) 表示右外连接
SELECT T1.NAME, T2.NAME 
FROM PRODUCTION.PRODUCT_CATEGORY T1, PRODUCTION.PRODUCT_SUBCATEGORY T2 
WHERE T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID(+);
-- 测试用例 6: 分区外连接 (PARTITION OUTER JOIN)
CREATE TABLE SALES.SALESREGION (
    REGION CHAR(10), 
    PRODUCTID INT, 
    AMOUNT INT
);
INSERT INTO SALES.SALESREGION VALUES ('大陆', 2, 19800);
INSERT INTO SALES.SALESREGION VALUES ('大陆', 4, 20090);
INSERT INTO SALES.SALESREGION VALUES ('港澳台', 6, 5698);
INSERT INTO SALES.SALESREGION VALUES ('外国', 9, 3756);
COMMIT;
SELECT A.PRODUCTID, B.REGION, B.AMOUNT 
FROM PRODUCTION.PRODUCT A 
LEFT JOIN SALES.SALESREGION B 
PARTITION BY (B.REGION) 
ON A.PRODUCTID = B.PRODUCTID 
ORDER BY A.PRODUCTID, B.REGION;
-- 测试用例 7: 左外连接与 WHERE 条件结合
SELECT T1.NAME, T2.NAME 
FROM PRODUCTION.PRODUCT_CATEGORY T1 
LEFT OUTER JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2 
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID 
WHERE T2.NAME IS NULL;
-- 测试用例 8: 右外连接与 WHERE 条件结合
SELECT T1.NAME, T2.NAME 
FROM PRODUCTION.PRODUCT_CATEGORY T1 
RIGHT OUTER JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2 
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID 
WHERE T1.NAME IS NULL;
-- 测试用例 9: 全外连接与 WHERE 条件结合
SELECT T1.NAME, T2.NAME 
FROM PRODUCTION.PRODUCT_CATEGORY T1 
FULL OUTER JOIN PRODUCTION.PRODUCT_SUBCATEGORY T2 
ON T1.PRODUCT_CATEGORYID = T2.PRODUCT_CATEGORYID 
WHERE T1.NAME IS NULL OR T2.NAME IS NULL;
-- 测试用例 10: 分区外连接与 ORDER BY 结合
SELECT A.PRODUCTID, B.REGION, B.AMOUNT 
FROM PRODUCTION.PRODUCT A 
LEFT JOIN SALES.SALESREGION B 
PARTITION BY (B.REGION) 
ON A.PRODUCTID = B.PRODUCTID 
ORDER BY B.REGION, A.PRODUCTID