-- 创建模式
CREATE SCHEMA PURCHASING;
-- 创建VENDOR表
CREATE TABLE PURCHASING.VENDOR (
    VENDORID INT PRIMARY KEY,
    ACCOUNTNO VARCHAR(20),
    NAME VARCHAR(100),
    ACTIVEFLAG INT,
    CREDIT INT
);
-- 插入一些测试数据
INSERT INTO PURCHASING.VENDOR (VENDORID, ACCOUNTNO, NAME, ACTIVEFLAG, CREDIT) VALUES (1, '001', 'Publisher A', 1, 0);
INSERT INTO PURCHASING.VENDOR (VENDORID, ACCOUNTNO, NAME, ACTIVEFLAG, CREDIT) VALUES (2, '002', 'Publisher B', 1, 1);
INSERT INTO PURCHASING.VENDOR (VENDORID, ACCOUNTNO, NAME, ACTIVEFLAG, CREDIT) VALUES (3, '003', 'Publisher C', 1, 1);
-- 创建物化视图日志
CREATE MATERIALIZED VIEW LOG ON PURCHASING.VENDOR WITH PRIMARY KEY;
-- 测试用例 1: 创建一个立即填充的物化视图，使用默认刷新选项
CREATE MATERIALIZED VIEW PURCHASING.MV_VENDOR_1 AS
SELECT VENDORID, ACCOUNTNO, NAME, ACTIVEFLAG, CREDIT
FROM PURCHASING.VENDOR
WHERE CREDIT = 1;
-- 测试用例 2: 创建一个延迟填充的物化视图，使用完全刷新
CREATE MATERIALIZED VIEW PURCHASING.MV_VENDOR_2 BUILD DEFERRED AS
SELECT VENDORID, ACCOUNTNO, NAME, ACTIVEFLAG, CREDIT
FROM PURCHASING.VENDOR
WHERE CREDIT = 1;
-- 测试用例 3: 创建一个物化视图，使用FAST刷新，ON COMMIT刷新时机
CREATE MATERIALIZED VIEW PURCHASING.MV_VENDOR_3 REFRESH FAST ON COMMIT AS
SELECT VENDORID, ACCOUNTNO, NAME, ACTIVEFLAG, CREDIT
FROM PURCHASING.VENDOR
WHERE CREDIT = 1;
-- 测试用例 4: 创建一个物化视图，使用FORCE刷新，ON DEMAND刷新时机
CREATE MATERIALIZED VIEW PURCHASING.MV_VENDOR_4 REFRESH FORCE ON DEMAND AS
SELECT VENDORID, ACCOUNTNO, NAME, ACTIVEFLAG, CREDIT
FROM PURCHASING.VENDOR
WHERE CREDIT = 1;
-- 测试用例 5: 创建一个物化视图，使用START WITH和NEXT指定刷新时间
CREATE MATERIALIZED VIEW PURCHASING.MV_VENDOR_5 REFRESH COMPLETE START WITH SYSDATE NEXT SYSDATE + 1 AS
SELECT VENDORID, ACCOUNTNO, NAME, ACTIVEFLAG, CREDIT
FROM PURCHASING.VENDOR
WHERE CREDIT = 1;
-- 测试用例 6: 创建一个物化视图，使用WITH ROWID刷新选项
CREATE MATERIALIZED VIEW PURCHASING.MV_VENDOR_6 REFRESH WITH ROWID AS
SELECT VENDORID, ACCOUNTNO, NAME, ACTIVEFLAG, CREDIT, ROWID AS X
FROM PURCHASING.VENDOR
WHERE CREDIT = 1;
-- 测试用例 7: 创建一个物化视图，禁用查询改写
CREATE MATERIALIZED VIEW PURCHASING.MV_VENDOR_7 DISABLE QUERY REWRITE AS
SELECT VENDORID, ACCOUNTNO, NAME, ACTIVEFLAG, CREDIT
FROM PURCHASING.VENDOR
WHERE CREDIT = 1;
-- 测试用例 8: 创建一个物化视图，使用NEVER REFRESH选项
CREATE MATERIALIZED VIEW PURCHASING.MV_VENDOR_8 NEVER REFRESH AS
SELECT VENDORID, ACCOUNTNO, NAME, ACTIVEFLAG, CREDIT
FROM PURCHASING.VENDOR
WHERE CREDIT = 1;
-- 测试用例 9: 创建一个物化视图，使用STORAGE子句
CREATE MATERIALIZED VIEW PURCHASING.MV_VENDOR_9 STORAGE (USING LONG ROW) AS
SELECT VENDORID, ACCOUNTNO, NAME, ACTIVEFLAG, CREDIT
FROM PURCHASING.VENDOR
WHERE CREDIT = 1;
-- 测试用例 10: 创建一个物化视图，使用ORDER BY子句
CREATE MATERIALIZED VIEW PURCHASING.MV_VENDOR_10 AS
SELECT VENDORID, ACCOUNTNO, NAME, ACTIVEFLAG, CREDIT
FROM PURCHASING.VENDOR
WHERE CREDIT = 1
ORDER BY VENDORID