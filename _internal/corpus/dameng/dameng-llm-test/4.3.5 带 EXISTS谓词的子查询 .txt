-- 创建EMPLOYEE表
CREATE TABLE RESOURCES.EMPLOYEE (
    EMPLOYEEID INT PRIMARY KEY,
    TITLE VARCHAR(50)
);
-- 创建EMPLOYEE_DEPARTMENT表
CREATE TABLE RESOURCES.EMPLOYEE_DEPARTMENT (
    EMPLOYEEID INT,
    STARTDATE DATE
);
-- 插入EMPLOYEE表数据
INSERT INTO RESOURCES.EMPLOYEE (EMPLOYEEID, TITLE) VALUES (1, '销售代表');
INSERT INTO RESOURCES.EMPLOYEE (EMPLOYEEID, TITLE) VALUES (2, '经理');
INSERT INTO RESOURCES.EMPLOYEE (EMPLOYEEID, TITLE) VALUES (3, '销售代表');
INSERT INTO RESOURCES.EMPLOYEE (EMPLOYEEID, TITLE) VALUES (4, '销售代表');
INSERT INTO RESOURCES.EMPLOYEE (EMPLOYEEID, TITLE) VALUES (5, '销售代表');
-- 插入EMPLOYEE_DEPARTMENT表数据
INSERT INTO RESOURCES.EMPLOYEE_DEPARTMENT (EMPLOYEEID, STARTDATE) VALUES (1, '2005-01-01');
INSERT INTO RESOURCES.EMPLOYEE_DEPARTMENT (EMPLOYEEID, STARTDATE) VALUES (2, '2005-02-01');
INSERT INTO RESOURCES.EMPLOYEE_DEPARTMENT (EMPLOYEEID, STARTDATE) VALUES (3, '2005-03-01');
INSERT INTO RESOURCES.EMPLOYEE_DEPARTMENT (EMPLOYEEID, STARTDATE) VALUES (4, '2005-04-01');
INSERT INTO RESOURCES.EMPLOYEE_DEPARTMENT (EMPLOYEEID, STARTDATE) VALUES (5, '2005-05-01');
SELECT T1.EMPLOYEEID, T1.STARTDATE
FROM RESOURCES.EMPLOYEE_DEPARTMENT T1
WHERE EXISTS (
    SELECT * 
    FROM RESOURCES.EMPLOYEE T2
    WHERE T2.EMPLOYEEID = T1.EMPLOYEEID AND T2.TITLE = '销售代表'
);
SELECT T1.EMPLOYEEID, T1.STARTDATE
FROM RESOURCES.EMPLOYEE_DEPARTMENT T1
WHERE NOT EXISTS (
    SELECT * 
    FROM RESOURCES.EMPLOYEE T2
    WHERE T2.EMPLOYEEID = T1.EMPLOYEEID AND T2.TITLE = '销售代表'
);
SELECT T1.EMPLOYEEID, T1.STARTDATE
FROM RESOURCES.EMPLOYEE_DEPARTMENT T1
WHERE EXISTS (
    SELECT * 
    FROM RESOURCES.EMPLOYEE T2
    WHERE T2.EMPLOYEEID = T1.EMPLOYEEID AND T2.TITLE = '经理'
);
SELECT T1.EMPLOYEEID, T1.STARTDATE
FROM RESOURCES.EMPLOYEE_DEPARTMENT T1
WHERE NOT EXISTS (
    SELECT * 
    FROM RESOURCES.EMPLOYEE T2
    WHERE T2.EMPLOYEEID = T1.EMPLOYEEID AND T2.TITLE = '经理'
);
SELECT T1.EMPLOYEEID, T1.STARTDATE
FROM RESOURCES.EMPLOYEE_DEPARTMENT T1
WHERE EXISTS (
    SELECT * 
    FROM RESOURCES.EMPLOYEE T2
    WHERE T2.EMPLOYEEID = T1.EMPLOYEEID AND T2.TITLE = '销售代表'
) AND T1.STARTDATE > '2005-01-01';
SELECT T1.EMPLOYEEID, T1.STARTDATE
FROM RESOURCES.EMPLOYEE_DEPARTMENT T1
WHERE NOT EXISTS (
    SELECT * 
    FROM RESOURCES.EMPLOYEE T2
    WHERE T2.EMPLOYEEID = T1.EMPLOYEEID AND T2.TITLE = '销售代表'
) AND T1.STARTDATE > '2005-01-01';
SELECT T1.EMPLOYEEID, T1.STARTDATE
FROM RESOURCES.EMPLOYEE_DEPARTMENT T1
WHERE EXISTS (
    SELECT * 
    FROM RESOURCES.EMPLOYEE T2
    WHERE T2.EMPLOYEEID = T1.EMPLOYEEID AND T2.TITLE = '销售代表'
) AND T1.STARTDATE < '2005-01-01';
SELECT T1.EMPLOYEEID, T1.STARTDATE
FROM RESOURCES.EMPLOYEE_DEPARTMENT T1
WHERE NOT EXISTS (
    SELECT * 
    FROM RESOURCES.EMPLOYEE T2
    WHERE T2.EMPLOYEEID = T1.EMPLOYEEID AND T2.TITLE = '销售代表'
) AND T1.STARTDATE < '2005-01-01';
SELECT T1.EMPLOYEEID, T1.STARTDATE
FROM RESOURCES.EMPLOYEE_DEPARTMENT T1
WHERE EXISTS (
    SELECT * 
    FROM RESOURCES.EMPLOYEE T2
    WHERE T2.EMPLOYEEID = T1.EMPLOYEEID AND T2.TITLE = '销售代表'
) AND T1.STARTDATE BETWEEN '2005-01-01' AND '2005-12-31';
SELECT T1.EMPLOYEEID, T1.STARTDATE
FROM RESOURCES.EMPLOYEE_DEPARTMENT T1
WHERE NOT EXISTS (
    SELECT * 
    FROM RESOURCES.EMPLOYEE T2
    WHERE T2.EMPLOYEEID = T1.EMPLOYEEID AND T2.TITLE = '销售代表'
) AND T1.STARTDATE BETWEEN '2005-01-01' AND '2005-12-31'