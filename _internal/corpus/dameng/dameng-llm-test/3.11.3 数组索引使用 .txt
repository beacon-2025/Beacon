-- 创建VARRAY数组类型
CREATE TYPE ARR_NUM1 IS VARRAY(1024) OF NUMBER;
/

-- 创建嵌套表类型
CREATE TYPE ARR_NUM2 IS TABLE OF NUMBER;
/

-- 创建动态数组类型
CREATE TYPE ARR_NUM3 IS ARRAY NUMBER[];
/

-- 创建静态数组类型
CREATE TYPE ARR_NUM4 IS ARRAY NUMBER[3];
/

-- 创建类CLS1
CREATE CLASS CLS1 AS V ARR_NUM1;
END;
/

-- 创建表TEST
CREATE TABLE TEST (C1 CLS1);
/

-- 插入测试数据
INSERT INTO TEST VALUES(CLS1(ARR_NUM1(1,2,3)));
INSERT INTO TEST VALUES(CLS1(ARR_NUM1(1,2)));
INSERT INTO TEST VALUES(CLS1(ARR_NUM1(2,1)));
INSERT INTO TEST VALUES(CLS1(ARR_NUM1(1,5)));
INSERT INTO TEST VALUES(CLS1(ARR_NUM1(2,4)));
INSERT INTO TEST VALUES(CLS1(ARR_NUM1(4,5,6)));
/

-- 创建数组索引
CREATE ARRAY INDEX IDX ON TEST(C1);
/;
-- 使用数组索引查询
SELECT * FROM TEST WHERE CONTAINS(C1,1,2,3);
/;
-- 使用嵌套表进行查询
DECLARE
    X ARR_NUM2;
BEGIN
    X := ARR_NUM2();
X.EXTEND(3);
X(1) := 1;
X(2) := 2;
X(3) := 3;
SELECT * FROM TEST WHERE CONTAINS(C1,X);
END;
/;
-- 使用动态数组进行查询
DECLARE
    X ARR_NUM3;
BEGIN
    X := NEW NUMBER [3];
X[1]:= 1;
X[2]:= 2;
X[3]:= 3;
SELECT * FROM TEST WHERE CONTAINS(C1,X);
END;
/;
-- 使用静态数组进行查询
DECLARE
    X ARR_NUM4;
BEGIN
    X[1]:= 1;
X[2]:= 2;
X[3]:= 3;
SELECT * FROM TEST WHERE CONTAINS(C1,X);
END;
/;
-- 使用数组索引查询单个值
SELECT * FROM TEST WHERE CONTAINS(C1,1);
/;
-- 使用数组索引查询多个值
SELECT * FROM TEST WHERE CONTAINS(C1,4,5,6);
/;
-- 使用嵌套表查询单个值
DECLARE
    X ARR_NUM2;
BEGIN
    X := ARR_NUM2();
X.EXTEND(1);
X(1) := 2;
SELECT * FROM TEST WHERE CONTAINS(C1,X);
END;
/;
-- 使用动态数组查询单个值
DECLARE
    X ARR_NUM3;
BEGIN
    X := NEW NUMBER [1];
X[1]:= 5;
SELECT * FROM TEST WHERE CONTAINS(C1,X);
END;
/;
-- 使用静态数组查询单个值
DECLARE
    X ARR_NUM4;
BEGIN
    X[1]:= 4;
X[2]:= NULL;
X[3]:= NULL;
SELECT * FROM TEST WHERE CONTAINS(C1,X);
END;
/;
-- 使用数组索引查询不存在的值
SELECT * FROM TEST WHERE CONTAINS(C1,7,8,9);
/