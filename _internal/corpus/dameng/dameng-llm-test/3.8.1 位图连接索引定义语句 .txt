-- 创建模式
CREATE SCHEMA SALES;
-- 创建事实表 SALESORDER_HEADER
CREATE TABLE SALES.SALESORDER_HEADER (
    CUSTOMERID INT PRIMARY KEY,
    TOTAL DECIMAL(10, 2)
);
-- 创建维度表 CUSTOMER
CREATE TABLE SALES.CUSTOMER (
    CUSTOMERID INT PRIMARY KEY,
    PERSONID INT UNIQUE
);
-- 测试用例 1: 创建位图连接索引
CREATE BITMAP INDEX SALES_CUSTOMER_NAME_IDX
ON SALES.SALESORDER_HEADER(SALES.CUSTOMER.PERSONID)
FROM SALES.CUSTOMER, SALES.SALESORDER_HEADER
WHERE SALES.CUSTOMER.CUSTOMERID = SALES.SALESORDER_HEADER.CUSTOMERID;
-- 测试用例 2: 创建位图连接索引并使用 OR REPLACE
CREATE OR REPLACE BITMAP INDEX SALES_CUSTOMER_NAME_IDX2
ON SALES.SALESORDER_HEADER(SALES.CUSTOMER.PERSONID)
FROM SALES.CUSTOMER, SALES.SALESORDER_HEADER
WHERE SALES.CUSTOMER.CUSTOMERID = SALES.SALESORDER_HEADER.CUSTOMERID;
-- 测试用例 3: 创建位图连接索引并指定存储子句
CREATE BITMAP INDEX SALES_CUSTOMER_NAME_IDX3
ON SALES.SALESORDER_HEADER(SALES.CUSTOMER.PERSONID)
FROM SALES.CUSTOMER, SALES.SALESORDER_HEADER
WHERE SALES.CUSTOMER.CUSTOMERID = SALES.SALESORDER_HEADER.CUSTOMERID
STORAGE(SECTION(4));
-- 测试用例 4: 创建位图连接索引并使用别名
CREATE BITMAP INDEX SALES_CUSTOMER_NAME_IDX4
ON SALES.SALESORDER_HEADER(C.PERSONID)
FROM SALES.CUSTOMER C, SALES.SALESORDER_HEADER S
WHERE C.CUSTOMERID = S.CUSTOMERID;
-- 测试用例 5: 创建位图连接索引并使用 DESC 排序
CREATE BITMAP INDEX SALES_CUSTOMER_NAME_IDX5
ON SALES.SALESORDER_HEADER(SALES.CUSTOMER.PERSONID DESC)
FROM SALES.CUSTOMER, SALES.SALESORDER_HEADER
WHERE SALES.CUSTOMER.CUSTOMERID = SALES.SALESORDER_HEADER.CUSTOMERID;
-- 测试用例 6: 创建位图连接索引并使用 ASC 排序
CREATE BITMAP INDEX SALES_CUSTOMER_NAME_IDX6
ON SALES.SALESORDER_HEADER(SALES.CUSTOMER.PERSONID ASC)
FROM SALES.CUSTOMER, SALES.SALESORDER_HEADER
WHERE SALES.CUSTOMER.CUSTOMERID = SALES.SALESORDER_HEADER.CUSTOMERID;
-- 测试用例 7: 创建位图连接索引并使用复合主键
-- 首先创建新的表和模式
CREATE SCHEMA MARKETING;
CREATE TABLE MARKETING.ORDERS (
    ORDERID INT,
    CUSTOMERID INT,
    PRIMARY KEY (ORDERID, CUSTOMERID)
);
CREATE TABLE MARKETING.CUSTOMERS (
    CUSTOMERID INT PRIMARY KEY,
    PERSONID INT UNIQUE
);
-- 创建位图连接索引
CREATE BITMAP INDEX MARKETING_ORDERS_CUSTOMER_IDX
ON MARKETING.ORDERS(MARKETING.CUSTOMERS.PERSONID)
FROM MARKETING.CUSTOMERS, MARKETING.ORDERS
WHERE MARKETING.CUSTOMERS.CUSTOMERID = MARKETING.ORDERS.CUSTOMERID;
-- 测试用例 8: 创建位图连接索引并使用不同的模式
CREATE BITMAP INDEX SALES_CUSTOMER_NAME_IDX7
ON SALES.SALESORDER_HEADER(MARKETING.CUSTOMERS.PERSONID)
FROM MARKETING.CUSTOMERS, SALES.SALESORDER_HEADER
WHERE MARKETING.CUSTOMERS.CUSTOMERID = SALES.SALESORDER_HEADER.CUSTOMERID;
-- 测试用例 9: 创建位图连接索引并使用不同的表别名
CREATE BITMAP INDEX SALES_CUSTOMER_NAME_IDX8
ON SALES.SALESORDER_HEADER(C.PERSONID)
FROM SALES.CUSTOMER C, SALES.SALESORDER_HEADER S
WHERE C.CUSTOMERID = S.CUSTOMERID;
-- 测试用例 10: 创建位图连接索引并使用不同的列名
-- 首先创建新的表和模式
CREATE SCHEMA INVENTORY;
CREATE TABLE INVENTORY.PRODUCTS (
    PRODUCTID INT PRIMARY KEY,
    PRODUCTNAME VARCHAR(100)
);
CREATE TABLE INVENTORY.ORDERS (
    ORDERID INT PRIMARY KEY,
    PRODUCTID INT
);
-- 创建位图连接索引
CREATE BITMAP INDEX INVENTORY_PRODUCTS_ORDERS_IDX
ON INVENTORY.ORDERS(INVENTORY.PRODUCTS.PRODUCTID)
FROM INVENTORY.PRODUCTS, INVENTORY.ORDERS
WHERE INVENTORY.PRODUCTS.PRODUCTID = INVENTORY.ORDERS.PRODUCTID