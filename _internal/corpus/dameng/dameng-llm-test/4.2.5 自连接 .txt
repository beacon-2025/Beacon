-- 创建PURCHASING.VENDOR表
CREATE TABLE PURCHASING.VENDOR (
    NAME VARCHAR(255),
    ACTIVEFLAG INT
);
-- 插入测试数据
INSERT INTO PURCHASING.VENDOR (NAME, ACTIVEFLAG) VALUES ('上海画报出版社', 1);
INSERT INTO PURCHASING.VENDOR (NAME, ACTIVEFLAG) VALUES ('长江文艺出版社', 1);
INSERT INTO PURCHASING.VENDOR (NAME, ACTIVEFLAG) VALUES ('北京十月文艺出版社', 1);
INSERT INTO PURCHASING.VENDOR (NAME, ACTIVEFLAG) VALUES ('人民邮电出版社', 1);
INSERT INTO PURCHASING.VENDOR (NAME, ACTIVEFLAG) VALUES ('清华大学出版社', 1);
INSERT INTO PURCHASING.VENDOR (NAME, ACTIVEFLAG) VALUES ('中华书局', 1);
INSERT INTO PURCHASING.VENDOR (NAME, ACTIVEFLAG) VALUES ('广州出版社', 1);
INSERT INTO PURCHASING.VENDOR (NAME, ACTIVEFLAG) VALUES ('上海出版社', 1);
INSERT INTO PURCHASING.VENDOR (NAME, ACTIVEFLAG) VALUES ('21世纪出版社', 1);
INSERT INTO PURCHASING.VENDOR (NAME, ACTIVEFLAG) VALUES ('外语教学与研究出版社', 1);
INSERT INTO PURCHASING.VENDOR (NAME, ACTIVEFLAG) VALUES ('机械工业出版社', 1);
INSERT INTO PURCHASING.VENDOR (NAME, ACTIVEFLAG) VALUES ('文学出版社', 1);
-- 测试用例1: 自连接查询，返回所有相同的NAME和ACTIVEFLAG
SELECT T1.NAME, T2.NAME, T1.ACTIVEFLAG
FROM PURCHASING.VENDOR T1, PURCHASING.VENDOR T2
WHERE T1.NAME = T2.NAME;
-- 测试用例2: 自连接查询，返回所有ACTIVEFLAG为1的记录
SELECT T1.NAME, T2.NAME, T1.ACTIVEFLAG
FROM PURCHASING.VENDOR T1, PURCHASING.VENDOR T2
WHERE T1.NAME = T2.NAME AND T1.ACTIVEFLAG = 1;
-- 测试用例3: 自连接查询，返回所有NAME以'上海'开头的记录
SELECT T1.NAME, T2.NAME, T1.ACTIVEFLAG
FROM PURCHASING.VENDOR T1, PURCHASING.VENDOR T2
WHERE T1.NAME = T2.NAME AND T1.NAME LIKE '上海%';
-- 测试用例4: 自连接查询，返回所有NAME以'出版社'结尾的记录
SELECT T1.NAME, T2.NAME, T1.ACTIVEFLAG
FROM PURCHASING.VENDOR T1, PURCHASING.VENDOR T2
WHERE T1.NAME = T2.NAME AND T1.NAME LIKE '%出版社';
-- 测试用例5: 自连接查询，返回所有NAME包含'文学'的记录
SELECT T1.NAME, T2.NAME, T1.ACTIVEFLAG
FROM PURCHASING.VENDOR T1, PURCHASING.VENDOR T2
WHERE T1.NAME = T2.NAME AND T1.NAME LIKE '%文学%';
-- 测试用例6: 自连接查询，返回所有NAME为'清华大学出版社'的记录
SELECT T1.NAME, T2.NAME, T1.ACTIVEFLAG
FROM PURCHASING.VENDOR T1, PURCHASING.VENDOR T2
WHERE T1.NAME = T2.NAME AND T1.NAME = '清华大学出版社';
-- 测试用例7: 自连接查询，返回所有NAME为'中华书局'且ACTIVEFLAG为1的记录
SELECT T1.NAME, T2.NAME, T1.ACTIVEFLAG
FROM PURCHASING.VENDOR T1, PURCHASING.VENDOR T2
WHERE T1.NAME = T2.NAME AND T1.NAME = '中华书局' AND T1.ACTIVEFLAG = 1;
-- 测试用例8: 自连接查询，返回所有NAME为'机械工业出版社'且ACTIVEFLAG为1的记录
SELECT T1.NAME, T2.NAME, T1.ACTIVEFLAG
FROM PURCHASING.VENDOR T1, PURCHASING.VENDOR T2
WHERE T1.NAME = T2.NAME AND T1.NAME = '机械工业出版社' AND T1.ACTIVEFLAG = 1;
-- 测试用例9: 自连接查询，返回所有NAME为'外语教学与研究出版社'且ACTIVEFLAG为1的记录
SELECT T1.NAME, T2.NAME, T1.ACTIVEFLAG
FROM PURCHASING.VENDOR T1, PURCHASING.VENDOR T2
WHERE T1.NAME = T2.NAME AND T1.NAME = '外语教学与研究出版社' AND T1.ACTIVEFLAG = 1;
-- 测试用例10: 自连接查询，返回所有NAME为'人民邮电出版社'且ACTIVEFLAG为1的记录
SELECT T1.NAME, T2.NAME, T1.ACTIVEFLAG
FROM PURCHASING.VENDOR T1, PURCHASING.VENDOR T2
WHERE T1.NAME = T2.NAME AND T1.NAME = '人民邮电出版社' AND T1.ACTIVEFLAG = 1