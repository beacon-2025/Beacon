-- 创建部门表
CREATE TABLE OTHER.DEPARTMENT (
    DEP_NAME VARCHAR2(50),
    HIGH_DEP VARCHAR2(50)
);
-- 插入测试数据
INSERT INTO OTHER.DEPARTMENT (DEP_NAME, HIGH_DEP) VALUES ('CEO', NULL);
INSERT INTO OTHER.DEPARTMENT (DEP_NAME, HIGH_DEP) VALUES ('VP1', 'CEO');
INSERT INTO OTHER.DEPARTMENT (DEP_NAME, HIGH_DEP) VALUES ('VP2', 'CEO');
INSERT INTO OTHER.DEPARTMENT (DEP_NAME, HIGH_DEP) VALUES ('Manager1', 'VP1');
INSERT INTO OTHER.DEPARTMENT (DEP_NAME, HIGH_DEP) VALUES ('Manager2', 'VP1');
INSERT INTO OTHER.DEPARTMENT (DEP_NAME, HIGH_DEP) VALUES ('Manager3', 'VP2');
INSERT INTO OTHER.DEPARTMENT (DEP_NAME, HIGH_DEP) VALUES ('Employee1', 'Manager1');
INSERT INTO OTHER.DEPARTMENT (DEP_NAME, HIGH_DEP) VALUES ('Employee2', 'Manager1');
INSERT INTO OTHER.DEPARTMENT (DEP_NAME, HIGH_DEP) VALUES ('Employee3', 'Manager2');
INSERT INTO OTHER.DEPARTMENT (DEP_NAME, HIGH_DEP) VALUES ('Employee4', 'Manager3');
SELECT HIGH_DEP, DEP_NAME 
FROM OTHER.DEPARTMENT 
CONNECT BY NOCYCLE PRIOR DEP_NAME = HIGH_DEP;
SELECT HIGH_DEP, DEP_NAME 
FROM OTHER.DEPARTMENT 
CONNECT BY NOCYCLE DEP_NAME = PRIOR HIGH_DEP;
SELECT CONNECT_BY_ROOT DEP_NAME AS ROOT_DEP, DEP_NAME 
FROM OTHER.DEPARTMENT 
CONNECT BY NOCYCLE PRIOR DEP_NAME = HIGH_DEP;
SELECT CONNECT_BY_ROOT HIGH_DEP AS ROOT_HIGH_DEP, DEP_NAME 
FROM OTHER.DEPARTMENT 
CONNECT BY NOCYCLE DEP_NAME = PRIOR HIGH_DEP;
SELECT HIGH_DEP, DEP_NAME 
FROM OTHER.DEPARTMENT 
WHERE PRIOR DEP_NAME = HIGH_DEP 
CONNECT BY NOCYCLE PRIOR DEP_NAME = HIGH_DEP;
SELECT HIGH_DEP, COUNT(*) 
FROM OTHER.DEPARTMENT 
GROUP BY PRIOR HIGH_DEP 
CONNECT BY NOCYCLE PRIOR DEP_NAME = HIGH_DEP;
SELECT HIGH_DEP, SUM(PRIOR DEP_NAME) 
FROM OTHER.DEPARTMENT 
CONNECT BY NOCYCLE PRIOR DEP_NAME = HIGH_DEP;
SELECT PRIOR DEP_NAME AS PARENT_DEP, DEP_NAME 
FROM OTHER.DEPARTMENT 
CONNECT BY NOCYCLE PRIOR DEP_NAME = HIGH_DEP;
SELECT HIGH_DEP, DEP_NAME 
FROM OTHER.DEPARTMENT 
WHERE DEP_NAME = 'Manager1' 
CONNECT BY NOCYCLE PRIOR DEP_NAME = HIGH_DEP;
SELECT HIGH_DEP, DEP_NAME 
FROM OTHER.DEPARTMENT 
WHERE DEP_NAME = 'VP1' 
CONNECT BY NOCYCLE DEP_NAME = PRIOR HIGH_DEP