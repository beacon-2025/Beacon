-- 创建表 PRODUCTION.PRODUCT
CREATE TABLE PRODUCTION.PRODUCT (
    PRODUCTID INT PRIMARY KEY,
    NAME VARCHAR(100),
    NOWPRICE DECIMAL(10, 2),
    PUBLISHTIME DATE
);
-- 插入测试数据
INSERT INTO PRODUCTION.PRODUCT (PRODUCTID, NAME, NOWPRICE, PUBLISHTIME) VALUES
(1, '红楼梦', 50.00, '2005-04-01'),
(2, '水浒传', 45.00, '2005-04-01'),
(3, '老人与海', 30.00, '2006-08-01'),
(4, '射雕英雄传(全四册)', 60.00, '2005-12-01'),
(5, '鲁迅文集(小说、散文、杂文)全两册', 55.00, '2006-09-01'),
(6, '长征', 70.00, '2006-09-01'),
(7, '数据结构(C语言版)(附光盘)', 80.00, '2007-03-01'),
(8, '工作中无小事', 25.00, '2006-01-01'),
(9, '噼里啪啦丛书(全 7册)', 90.00, '2007-05-01'),
(10, 'Java编程思想', 85.00, '2007-06-01');
-- 查询现价最贵的两种产品的编号和名称
SELECT TOP 2 PRODUCTID, NAME FROM PRODUCTION.PRODUCT ORDER BY NOWPRICE DESC;
-- 查询现价第二贵的产品的编号和名称
SELECT TOP 1,1 PRODUCTID, NAME FROM PRODUCTION.PRODUCT ORDER BY NOWPRICE DESC;
-- 查询最新出版日期的70%的产品编号、名称和出版日期
SELECT TOP 70 PERCENT PRODUCTID, NAME, PUBLISHTIME FROM PRODUCTION.PRODUCT ORDER BY PUBLISHTIME DESC;
-- 查询现价最贵的两种产品的编号和名称，并包含并列行
SELECT TOP 2 WITH TIES PRODUCTID, NAME FROM PRODUCTION.PRODUCT ORDER BY NOWPRICE DESC;
-- 查询最新出版日期的70%的产品编号、名称和出版日期，并包含并列行
SELECT TOP 70 PERCENT WITH TIES PRODUCTID, NAME, PUBLISHTIME FROM PRODUCTION.PRODUCT ORDER BY PUBLISHTIME DESC;
-- 查询前3条产品的编号和名称
SELECT TOP 3 PRODUCTID, NAME FROM PRODUCTION.PRODUCT;
-- 查询前50%的产品的编号和名称
SELECT TOP 50 PERCENT PRODUCTID, NAME FROM PRODUCTION.PRODUCT;
-- 查询前2条产品的编号和名称，不带ORDER BY（WITH TIES被忽略）
SELECT TOP 2 WITH TIES PRODUCTID, NAME FROM PRODUCTION.PRODUCT;
-- 查询前30%的产品的编号和名称，不带ORDER BY（WITH TIES被忽略）
SELECT TOP 30 PERCENT WITH TIES PRODUCTID, NAME FROM PRODUCTION.PRODUCT;
-- 查询现价最便宜的3种产品的编号和名称
SELECT TOP 3 PRODUCTID, NAME FROM PRODUCTION.PRODUCT ORDER BY NOWPRICE ASC;
-- 查询现价第三贵的产品的编号和名称
SELECT TOP 2,1 PRODUCTID, NAME FROM PRODUCTION.PRODUCT ORDER BY NOWPRICE DESC;
-- 查询最早出版日期的50%的产品编号、名称和出版日期
SELECT TOP 50 PERCENT PRODUCTID, NAME, PUBLISHTIME FROM PRODUCTION.PRODUCT ORDER BY PUBLISHTIME ASC;
-- 查询现价最便宜的两种产品的编号和名称，并包含并列行
SELECT TOP 2 WITH TIES PRODUCTID, NAME FROM PRODUCTION.PRODUCT ORDER BY NOWPRICE ASC;
-- 查询最早出版日期的30%的产品编号、名称和出版日期，并包含并列行
SELECT TOP 30 PERCENT WITH TIES PRODUCTID, NAME, PUBLISHTIME FROM PRODUCTION.PRODUCT ORDER BY PUBLISHTIME ASC;
-- 查询现价大于50的最贵的两种产品的编号和名称
SELECT TOP 2 PRODUCTID, NAME FROM PRODUCTION.PRODUCT WHERE NOWPRICE > 50 ORDER BY NOWPRICE DESC;
-- 查询现价大于50的第二贵的产品的编号和名称
SELECT TOP 1,1 PRODUCTID, NAME FROM PRODUCTION.PRODUCT WHERE NOWPRICE > 50 ORDER BY NOWPRICE DESC;
-- 查询现价大于50的最新出版日期的70%的产品编号、名称和出版日期
SELECT TOP 70 PERCENT PRODUCTID, NAME, PUBLISHTIME FROM PRODUCTION.PRODUCT WHERE NOWPRICE > 50 ORDER BY PUBLISHTIME DESC;
-- 查询现价大于50的最贵的两种产品的编号和名称，并包含并列行
SELECT TOP 2 WITH TIES PRODUCTID, NAME FROM PRODUCTION.PRODUCT WHERE NOWPRICE > 50 ORDER BY NOWPRICE DESC;
-- 查询现价大于50的最新出版日期的70%的产品编号、名称和出版日期，并包含并列行
SELECT TOP 70 PERCENT WITH TIES PRODUCTID, NAME, PUBLISHTIME FROM PRODUCTION.PRODUCT WHERE NOWPRICE > 50 ORDER BY PUBLISHTIME DESC;
-- 查询每个出版年份中最贵的两种产品的编号和名称
SELECT TOP 2 PRODUCTID, NAME FROM PRODUCTION.PRODUCT GROUP BY YEAR(PUBLISHTIME) ORDER BY NOWPRICE DESC