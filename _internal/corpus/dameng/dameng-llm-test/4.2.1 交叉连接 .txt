-- 创建表 RESOURCES.EMPLOYEE
CREATE TABLE RESOURCES.EMPLOYEE (
    PERSONID INT PRIMARY KEY,
    HAIRDATE DATE,
    NAME VARCHAR(50),
    SEX CHAR(1)
);
-- 创建表 SALES.SALESPERSON
CREATE TABLE SALES.SALESPERSON (
    PERSONID INT PRIMARY KEY,
    SALESLASTYEAR DECIMAL(10, 4),
    TITLE VARCHAR(50)
);
-- 创建表 PERSON.PERSON
CREATE TABLE PERSON.PERSON (
    PERSONID INT PRIMARY KEY,
    NAME VARCHAR(50),
    SEX CHAR(1)
);
-- 插入数据到 RESOURCES.EMPLOYEE
INSERT INTO RESOURCES.EMPLOYEE (PERSONID, HAIRDATE, NAME, SEX) VALUES
(1, '2002-05-02', '王刚', 'M'),
(2, '2005-05-02', '李勇', 'M'),
(3, '2004-05-02', '黄非', 'M'),
(4, '2002-05-02', '张平', 'M');
-- 插入数据到 SALES.SALESPERSON
INSERT INTO SALES.SALESPERSON (PERSONID, SALESLASTYEAR, TITLE) VALUES
(1, 10.0000, '销售经理'),
(2, 20.0000, '采购经理'),
(3, 10.0000, '采购代表'),
(4, 20.0000, '系统管理员');
-- 插入数据到 PERSON.PERSON
INSERT INTO PERSON.PERSON (PERSONID, NAME, SEX) VALUES
(1, '王刚', 'M'),
(2, '李勇', 'M'),
(3, '黄非', 'M'),
(4, '张平', 'M');
-- 查询 RESOURCES.EMPLOYEE 和 SALES.SALESPERSON 的交叉连接
SELECT T1.HAIRDATE, T2.SALESLASTYEAR
FROM RESOURCES.EMPLOYEE T1
CROSS JOIN SALES.SALESPERSON T2;
-- 查询性别为男性的员工的姓名与职务
SELECT T1.NAME, T2.TITLE
FROM PERSON.PERSON T1
JOIN RESOURCES.EMPLOYEE T2 ON T1.PERSONID = T2.PERSONID
WHERE T1.SEX = 'M';
-- 查询 SALESLASTYEAR 大于 15 的员工的姓名与职务
SELECT T1.NAME, T2.TITLE
FROM PERSON.PERSON T1
JOIN SALES.SALESPERSON T2 ON T1.PERSONID = T2.PERSONID
WHERE T2.SALESLASTYEAR > 15;
-- 查询 SALESLASTYEAR 不等于 10 的员工的姓名与职务
SELECT T1.NAME, T2.TITLE
FROM PERSON.PERSON T1
JOIN SALES.SALESPERSON T2 ON T1.PERSONID = T2.PERSONID
WHERE T2.SALESLASTYEAR <> 10;
-- 查询性别为男性且 SALESLASTYEAR 大于 15 的员工的姓名与职务
SELECT T1.NAME, T2.TITLE
FROM PERSON.PERSON T1
JOIN SALES.SALESPERSON T2 ON T1.PERSONID = T2.PERSONID
WHERE T1.SEX = 'M' AND T2.SALESLASTYEAR > 15;
-- 假设 EMPLOYEE 表的 PERSONID 列名为 EMPLOYEEID
ALTER TABLE RESOURCES.EMPLOYEE RENAME COLUMN PERSONID TO EMPLOYEEID;
-- 查询性别为男性的员工的姓名与职务
SELECT T1.NAME, T2.TITLE
FROM PERSON.PERSON T1
JOIN RESOURCES.EMPLOYEE T2 ON T1.PERSONID = T2.EMPLOYEEID
WHERE T1.SEX = 'M';
-- 假设 EMPLOYEE 表的 PERSONID 列类型为 VARCHAR
ALTER TABLE RESOURCES.EMPLOYEE ALTER COLUMN EMPLOYEEID TYPE VARCHAR(50);
-- 查询性别为男性的员工的姓名与职务
SELECT T1.NAME, T2.TITLE
FROM PERSON.PERSON T1
JOIN RESOURCES.EMPLOYEE T2 ON T1.PERSONID = T2.EMPLOYEEID
WHERE T1.SEX = 'M';
-- 查询 RESOURCES.EMPLOYEE 和 SALES.SALESPERSON 的交叉连接，使用路径名
SELECT T1.HAIRDATE, T2.SALESLASTYEAR
FROM /home/user/database/RESOURCES.EMPLOYEE T1
CROSS JOIN /home/user/database/SALES.SALESPERSON T2;
-- 创建新表 RESOURCES.EMPLOYEE_NEW
CREATE TABLE RESOURCES.EMPLOYEE_NEW (
    PERSONID INT PRIMARY KEY,
    HAIRDATE DATE,
    NAME VARCHAR(50),
    SEX CHAR(1)
);
-- 插入数据到 RESOURCES.EMPLOYEE_NEW
INSERT INTO RESOURCES.EMPLOYEE_NEW (PERSONID, HAIRDATE, NAME, SEX) VALUES
(1, '2002-05-02', '王刚', 'M'),
(2, '2005-05-02', '李勇', 'M'),
(3, '2004-05-02', '黄非', 'M'),
(4, '2002-05-02', '张平', 'M');
-- 查询 RESOURCES.EMPLOYEE_NEW 和 SALES.SALESPERSON 的交叉连接
SELECT T1.HAIRDATE, T2.SALESLASTYEAR
FROM RESOURCES.EMPLOYEE_NEW T1
CROSS JOIN SALES.SALESPERSON T2;
-- 创建新表 SALES.SALESPERSON_NEW
CREATE TABLE SALES.SALESPERSON_NEW (
    EMPLOYEEID INT PRIMARY KEY,
    SALESLASTYEAR DECIMAL(10, 4),
    TITLE VARCHAR(50)
);
-- 插入数据到 SALES.SALESPERSON_NEW
INSERT INTO SALES.SALESPERSON_NEW (EMPLOYEEID, SALESLASTYEAR, TITLE) VALUES
(1, 10.0000, '销售经理'),
(2, 20.0000, '采购经理'),
(3, 10.0000, '采购代表'),
(4, 20.0000, '系统管理员');
-- 查询 RESOURCES.EMPLOYEE 和 SALES.SALESPERSON_NEW 的交叉连接
SELECT T1.HAIRDATE, T2.SALESLASTYEAR
FROM RESOURCES.EMPLOYEE T1
CROSS JOIN SALES.SALESPERSON_NEW T2